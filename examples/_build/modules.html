

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Python Module Workflows &mdash; Elastic Net Analysis - Workflow Documentation 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css" />
      <link rel="stylesheet" type="text/css" href="_static/workflow.css?v=4ddc2446" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8d563738"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/workflow.js?v=030014fe"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Notebook Workflows" href="notebooks.html" />
    <link rel="prev" title="Auto-Discovery Workflow Index" href="workflow_index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Elastic Net Analysis - Workflow Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="workflow_index.html">Auto-Discovery Workflow Index</a><ul>
<li class="toctree-l2"><a class="reference internal" href="workflow_index.html#basic-usage">Basic Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_index.html#with-custom-options">With Custom Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_index.html#configuration-in-conf-py">Configuration in conf.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_index.html#live-example">Live Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_index.html#discovered-workflow-markers">Discovered Workflow Markers</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflow_index.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python Module Workflows</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-elastic_net_modules.model_selection">Model Selection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.model_selection.evaluate_all_feature_sets"><code class="docutils literal notranslate"><span class="pre">evaluate_all_feature_sets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.model_selection.apply_1se_rule"><code class="docutils literal notranslate"><span class="pre">apply_1se_rule()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.model_selection.build_final_classifier"><code class="docutils literal notranslate"><span class="pre">build_final_classifier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.model_selection.build_calibrated_classifier"><code class="docutils literal notranslate"><span class="pre">build_calibrated_classifier()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.model_selection.find_optimal_threshold"><code class="docutils literal notranslate"><span class="pre">find_optimal_threshold()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-elastic_net_modules.data_loading">Data Loading</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.data_loading.AdataProcessor"><code class="docutils literal notranslate"><span class="pre">AdataProcessor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.data_loading.AdataProcessor.cell_line"><code class="docutils literal notranslate"><span class="pre">AdataProcessor.cell_line</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.data_loading.AdataProcessor.cell_info"><code class="docutils literal notranslate"><span class="pre">AdataProcessor.cell_info</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.data_loading.AdataProcessor.adata"><code class="docutils literal notranslate"><span class="pre">AdataProcessor.adata</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.data_loading.AdataProcessor.phate_coords_obsm_key"><code class="docutils literal notranslate"><span class="pre">AdataProcessor.phate_coords_obsm_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.data_loading.AdataProcessor.phate_params_uns_key"><code class="docutils literal notranslate"><span class="pre">AdataProcessor.phate_params_uns_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.data_loading.AdataProcessor.phase_labels_obs_key"><code class="docutils literal notranslate"><span class="pre">AdataProcessor.phase_labels_obs_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.data_loading.AdataProcessor.phase_label_colors_obs_key"><code class="docutils literal notranslate"><span class="pre">AdataProcessor.phase_label_colors_obs_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.data_loading.AdataProcessor.__init__"><code class="docutils literal notranslate"><span class="pre">AdataProcessor.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.data_loading.AdataProcessor.add_random_forest_feature_set"><code class="docutils literal notranslate"><span class="pre">AdataProcessor.add_random_forest_feature_set()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.data_loading.AdataProcessor.add_phate_coordinates"><code class="docutils literal notranslate"><span class="pre">AdataProcessor.add_phate_coordinates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.data_loading.AdataProcessor.add_phase_labels"><code class="docutils literal notranslate"><span class="pre">AdataProcessor.add_phase_labels()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.data_loading.AdataProcessor.process_all"><code class="docutils literal notranslate"><span class="pre">AdataProcessor.process_all()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-elastic_net_modules.feature_engineering">Feature Engineering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.feature_engineering.log_transform_features"><code class="docutils literal notranslate"><span class="pre">log_transform_features()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.feature_engineering.generate_all_feature_combinations"><code class="docutils literal notranslate"><span class="pre">generate_all_feature_combinations()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.feature_engineering.logsumexp10"><code class="docutils literal notranslate"><span class="pre">logsumexp10()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.feature_engineering.compute_composite_features"><code class="docutils literal notranslate"><span class="pre">compute_composite_features()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.feature_engineering.print_feature_set_summary"><code class="docutils literal notranslate"><span class="pre">print_feature_set_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-elastic_net_modules.preprocessing">Preprocessing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.preprocessing.label_ploidy_and_proliferation"><code class="docutils literal notranslate"><span class="pre">label_ploidy_and_proliferation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.preprocessing.label_ploidy_and_proliferation_gmm"><code class="docutils literal notranslate"><span class="pre">label_ploidy_and_proliferation_gmm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.preprocessing.apply_percentile_filter_from_subset"><code class="docutils literal notranslate"><span class="pre">apply_percentile_filter_from_subset()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.preprocessing.prepare_data_for_elastic_net"><code class="docutils literal notranslate"><span class="pre">prepare_data_for_elastic_net()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-elastic_net_modules.nested_cv">Nested Cross-Validation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.nested_cv.nested_cv_single_feature_set"><code class="docutils literal notranslate"><span class="pre">nested_cv_single_feature_set()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-elastic_net_modules.results_manager">Results Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#key-features">Key Features:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#typical-usage-flow">Typical Usage Flow:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#classes">Classes:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.results_manager.generate_analysis_id"><code class="docutils literal notranslate"><span class="pre">generate_analysis_id()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager"><code class="docutils literal notranslate"><span class="pre">ElasticNetResultsManager</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.__init__"><code class="docutils literal notranslate"><span class="pre">ElasticNetResultsManager.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.save_metadata"><code class="docutils literal notranslate"><span class="pre">ElasticNetResultsManager.save_metadata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.save_model_results"><code class="docutils literal notranslate"><span class="pre">ElasticNetResultsManager.save_model_results()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.load_model_results"><code class="docutils literal notranslate"><span class="pre">ElasticNetResultsManager.load_model_results()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.save_plot"><code class="docutils literal notranslate"><span class="pre">ElasticNetResultsManager.save_plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.save_preprocessing_plot"><code class="docutils literal notranslate"><span class="pre">ElasticNetResultsManager.save_preprocessing_plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.save_final_classifier"><code class="docutils literal notranslate"><span class="pre">ElasticNetResultsManager.save_final_classifier()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.load_final_classifier"><code class="docutils literal notranslate"><span class="pre">ElasticNetResultsManager.load_final_classifier()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.get_checkpoint_dir"><code class="docutils literal notranslate"><span class="pre">ElasticNetResultsManager.get_checkpoint_dir()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.add_preprocessing_info"><code class="docutils literal notranslate"><span class="pre">ElasticNetResultsManager.add_preprocessing_info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.create_summary"><code class="docutils literal notranslate"><span class="pre">ElasticNetResultsManager.create_summary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.load"><code class="docutils literal notranslate"><span class="pre">ElasticNetResultsManager.load()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-elastic_net_modules.visualization">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.visualization.plot_model_selection"><code class="docutils literal notranslate"><span class="pre">plot_model_selection()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.visualization.plot_coefficient_stability"><code class="docutils literal notranslate"><span class="pre">plot_coefficient_stability()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.visualization.plot_feature_importance"><code class="docutils literal notranslate"><span class="pre">plot_feature_importance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.visualization.plot_threshold_sweep"><code class="docutils literal notranslate"><span class="pre">plot_threshold_sweep()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.visualization.plot_null_distribution"><code class="docutils literal notranslate"><span class="pre">plot_null_distribution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.visualization.plot_bootstrap_distribution"><code class="docutils literal notranslate"><span class="pre">plot_bootstrap_distribution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.visualization.plot_performance_summary"><code class="docutils literal notranslate"><span class="pre">plot_performance_summary()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#elastic_net_modules.visualization.plot_scatter_kde"><code class="docutils literal notranslate"><span class="pre">plot_scatter_kde()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Notebook Workflows</a><ul>
<li class="toctree-l2"><a class="reference internal" href="notebooks.html#nested-cv-analysis">Nested CV Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks.html#feature-set-exploration">Feature Set Exploration</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks.html#model-evaluation">Model Evaluation</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Elastic Net Analysis - Workflow Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Python Module Workflows</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/modules.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="python-module-workflows">
<h1>Python Module Workflows<a class="headerlink" href="#python-module-workflows" title="Link to this heading"></a></h1>
<p>This section documents the workflow protocols in Python modules.</p>
<section id="module-elastic_net_modules.model_selection">
<span id="model-selection"></span><h2>Model Selection<a class="headerlink" href="#module-elastic_net_modules.model_selection" title="Link to this heading"></a></h2>
<p>Model Selection Module for Elastic Net Analysis</p>
<p>This module implements model selection functions:
1. evaluate_all_feature_sets() - Run nested CV on all 128 feature sets
2. apply_1se_rule() - Select simplest model within 1 SE of best
3. build_final_classifier() - Train final model on 100% data
4. find_optimal_threshold() - Maximize MCC on validation set</p>
<p># WORKFLOWS: evaluation_overview, evaluation_detailed, evaluation_full</p>
<p>Author: AI Assistant
Date: November 12, 2025
Status: Phase 1.3 Implementation</p>
<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.model_selection.evaluate_all_feature_sets">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.model_selection.</span></span><span class="sig-name descname"><span class="pre">evaluate_all_feature_sets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_combinations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><span class="pre">ElasticNetResultsManager</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer_cv_splits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer_cv_repeats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_cv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_checkpoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_composite_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/model_selection.html#evaluate_all_feature_sets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.model_selection.evaluate_all_feature_sets" title="Link to this definition"></a></dt>
<dd><p>Evaluate all 128 feature set models using nested CV with parallelization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – Single-cell data object with RAW protein intensities</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – Binary labels (0/1)</p></li>
<li><p><strong>feature_combinations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Output from generate_all_feature_combinations()
Each dict must have ‘id’ key (0-127) for consistent model identification</p></li>
<li><p><strong>param_grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameter grid for Elastic Net
Example: {‘C’: [0.1, 1.0, 10.0], ‘l1_ratio’: [0.1, 0.5, 0.9]}</p></li>
<li><p><strong>results_manager</strong> (<a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><em>ElasticNetResultsManager</em></a>) – Results manager instance for organizing all outputs.
Automatically handles checkpoints, warnings, and final results saving.
<strong>REQUIRED</strong> - no longer optional for clean, organized results.</p></li>
<li><p><strong>outer_cv_splits</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of splits for RepeatedStratifiedKFold outer loop (default 10)</p></li>
<li><p><strong>outer_cv_repeats</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of repeats for RepeatedStratifiedKFold outer loop (default 1)</p></li>
<li><p><strong>inner_cv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of inner CV folds for GridSearchCV (default 5)</p></li>
<li><p><strong>random_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Random seed for reproducibility</p></li>
<li><p><strong>n_jobs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of parallel jobs for feature set evaluation (-1 = all cores)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Verbosity level:
- 0: Silent (no output)
- 1: Feature set progress bar only (default)
- 2: Feature set + nested fold progress bars</p></li>
<li><p><strong>resume</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – If True, skip feature sets that already have checkpoint files (default True)</p></li>
<li><p><strong>keep_checkpoints</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – If True, keep individual JSON checkpoint files after combining (default False)
If False, remove checkpoints/ directory entirely after successful combination</p></li>
<li><p><strong>use_composite_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Legacy parameter. Ignored if feature_mode is provided.</p></li>
<li><p><strong>feature_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – ‘base’, ‘mixed’, or ‘composite’. If None, inferred from use_composite_features.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>results_df</strong> – Also automatically saved via results_manager.save_model_results()
Columns:
- model_id: int (0-127, from feature_set_config[‘id’])
- model_name: str (e.g., “CycD1_CDK4_p27”)
- features: list of str (proteins in this set)
- n_base_features: int (number of proteins, 0-7)
- n_total_features: int (proteins + 5 composites, varies after NaN removal)
- mean_auroc: float (mean across outer folds)
- se_auroc: float (standard error = SD / sqrt(n_folds))
- sd_auroc: float (standard deviation of fold scores)
- fold_scores: list of float (AUROC for each outer fold)
- best_params: dict (most common hyperparameters across folds)
- timestamp: str (ISO format)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">elastic_net_modules</span><span class="w"> </span><span class="kn">import</span> <span class="n">ElasticNetResultsManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span> <span class="o">=</span> <span class="n">ElasticNetResultsManager</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">cell_line</span><span class="o">=</span><span class="s2">&quot;CFPAC&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">condition</span><span class="o">=</span><span class="s2">&quot;control&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">additional_info</span><span class="o">=</span><span class="s2">&quot;g0g1&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results_df</span> <span class="o">=</span> <span class="n">evaluate_all_feature_sets</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">adata</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">feature_combos</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">results_manager</span><span class="o">=</span><span class="n">manager</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.model_selection.apply_1se_rule">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.model_selection.</span></span><span class="sig-name descname"><span class="pre">apply_1se_rule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mean_auroc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/model_selection.html#apply_1se_rule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.model_selection.apply_1se_rule" title="Link to this definition"></a></dt>
<dd><p>Apply the 1-SE rule to select the simplest good model.</p>
<p>The 1-SE rule selects the simplest model (fewest features) whose performance
is within one standard error of the best model. This balances performance
with interpretability and reduces overfitting risk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results_df</strong> (<em>pd.DataFrame</em>) – Output from evaluate_all_feature_sets()
Must have columns: model_id, model_name, n_total_features, mean_auroc, se_auroc</p></li>
<li><p><strong>metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Metric column name to use for selection (default ‘mean_auroc’)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Print selection details and reasoning (default True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>selection_results</strong> –</p>
<dl class="simple">
<dt>{</dt><dd><p>‘primary_model’: dict (highest AUROC among tied simplest models),
‘all_candidates’: list of dict (all models within 1-SE threshold),
‘tied_simplest’: list of dict (all models tied for min n_features, if tie exists),
‘selection_reason’: str (detailed explanation),
‘threshold’: float (mean_auroc_best - se_best),
‘best_model’: dict (model with max mean_auroc, for reference)</p>
</dd>
</dl>
<p>}</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.model_selection.build_final_classifier">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.model_selection.</span></span><span class="sig-name descname"><span class="pre">build_final_classifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_set_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_folds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_composite_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/model_selection.html#build_final_classifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.model_selection.build_final_classifier" title="Link to this definition"></a></dt>
<dd><p>Build the final, deployable classifier trained on 100% of data.</p>
<p>This function performs a complete training workflow:
1. Re-run hyperparameter search on full dataset (no data held out)
2. Train final model with optimal hyperparameters
3. Find optimal classification threshold using out-of-fold predictions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – Single-cell data object with RAW protein intensities</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – Binary labels (0/1)</p></li>
<li><p><strong>feature_set_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Configuration for the selected feature set (from apply_1se_rule)</p></li>
<li><p><strong>param_grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameter grid for re-running GridSearchCV</p></li>
<li><p><strong>cv_folds</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of CV folds for threshold optimization (default 10)
Uses StratifiedKFold (not Repeated) for out-of-fold predictions</p></li>
<li><p><strong>random_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Random seed for reproducibility</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Print progress information (default True)</p></li>
<li><p><strong>use_composite_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Legacy parameter. Ignored if feature_mode is provided.</p></li>
<li><p><strong>feature_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – ‘base’, ‘mixed’, or ‘composite’. If None, inferred from use_composite_features.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>final_classifier</strong> – Complete deployable classifier package</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.model_selection.build_calibrated_classifier">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.model_selection.</span></span><span class="sig-name descname"><span class="pre">build_calibrated_classifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_set_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_folds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_composite_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/model_selection.html#build_calibrated_classifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.model_selection.build_calibrated_classifier" title="Link to this definition"></a></dt>
<dd><p>Build calibrated classifier with isotonic regression and valid OOF predictions.</p>
<p>This function implements a 4-step workflow for building calibrated models:
1. Grid Search with scoring=’roc_auc’ to find best hyperparameters
2. Create CalibratedClassifierCV with isotonic method
3. Generate out-of-fold predictions using cross_val_predict (for valid Brier scores)
4. Fit final calibrated model on all data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – Single-cell data object with RAW protein intensities</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – Binary labels (0/1)</p></li>
<li><p><strong>feature_set_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Configuration for the selected feature set</p></li>
<li><p><strong>param_grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameter grid for GridSearchCV (e.g., {‘C’: […], ‘l1_ratio’: […]})</p></li>
<li><p><strong>cv_folds</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of CV folds for calibration and OOF predictions (default 5)</p></li>
<li><p><strong>random_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Random seed for reproducibility</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Print progress information (default True)</p></li>
<li><p><strong>use_composite_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Legacy parameter. Ignored if feature_mode is provided.</p></li>
<li><p><strong>feature_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – ‘base’, ‘mixed’, or ‘composite’. If None, inferred from use_composite_features.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>calibrated_classifier</strong> – Complete deployable classifier package with:
- ‘model’: Fitted CalibratedClassifierCV
- ‘scaler’: Fitted StandardScaler
- ‘oof_probs’: Out-of-fold probabilities (for valid Brier calculation)
- ‘valid_rows’: Boolean mask of valid samples (after NaN removal)
- ‘feature_names’: List of feature names
- ‘best_params’: Best hyperparameters from grid search
- ‘is_calibrated’: True flag
- Other metadata</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.model_selection.find_optimal_threshold">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.model_selection.</span></span><span class="sig-name descname"><span class="pre">find_optimal_threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred_proba</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'mcc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/model_selection.html#find_optimal_threshold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.model_selection.find_optimal_threshold" title="Link to this definition"></a></dt>
<dd><p>Find optimal classification threshold by linear sweep to maximize metric.</p>
<p>Sweeps through threshold values from threshold_step to (1 - threshold_step)
and selects the threshold that maximizes the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – True binary labels (0/1)</p></li>
<li><p><strong>y_pred_proba</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – Predicted probabilities from classifier (values in [0, 1])</p></li>
<li><p><strong>metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Metric to optimize (default ‘mcc’)
Options: ‘mcc’ (Matthews Correlation Coefficient), ‘f1’ (F1 score)</p></li>
<li><p><strong>threshold_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Resolution for threshold sweep (default 0.01)</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Print optimal threshold and metric value (default True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>results</strong> –</p>
<dl class="simple">
<dt>{</dt><dd><p>‘optimal_threshold’: float,
‘max_metric_value’: float,
‘all_thresholds’: np.ndarray,
‘all_metric_values’: np.ndarray,
‘metric_name’: str</p>
</dd>
</dl>
<p>}</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<p>The above will automatically extract and display the workflow documentation!</p>
<hr class="docutils" />
<p>Or use the directive explicitly:</p>
</section>
<hr class="docutils" />
<section id="module-elastic_net_modules.data_loading">
<span id="data-loading"></span><h2>Data Loading<a class="headerlink" href="#module-elastic_net_modules.data_loading" title="Link to this heading"></a></h2>
<p>Data loading utilities for Elastic Net Analysis.</p>
<p>This module provides the AdataProcessor class for loading and enriching AnnData
objects with cell cycle data, without requiring Palantir dependencies.</p>
<dl class="py class">
<dt class="sig sig-object py" id="elastic_net_modules.data_loading.AdataProcessor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">elastic_net_modules.data_loading.</span></span><span class="sig-name descname"><span class="pre">AdataProcessor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_line</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimal_cell_lines_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdac_data_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc_mapping_package_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata_filename_suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'_GMM_DIP.h5ad'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phate_coords_obsm_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'PhateCoords'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phate_params_uns_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'phate_coords_args'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_labels_obs_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'PhaseLabels'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_label_colors_obs_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'PhaseLabelColors'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_set_var_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'in_random_forest_fs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_set_uns_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'random_forest_fs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_forest_fs_name_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'RandomForestFeatureSets'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_forest_fs_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'RandomForestFeatureSet'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/data_loading.html#AdataProcessor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.data_loading.AdataProcessor" title="Link to this definition"></a></dt>
<dd><p>Processes AnnData objects for cell cycle elastic net analysis.</p>
<p>This class loads a base AnnData object for a given cell line and provides
methods to sequentially add different data layers required for analysis,
such as dimensionality reduction coordinates and cell cycle phase labels.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="elastic_net_modules.data_loading.AdataProcessor.cell_line">
<span class="sig-name descname"><span class="pre">cell_line</span></span><a class="headerlink" href="#elastic_net_modules.data_loading.AdataProcessor.cell_line" title="Link to this definition"></a></dt>
<dd><p>The name of the cell line being processed.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="elastic_net_modules.data_loading.AdataProcessor.cell_info">
<span class="sig-name descname"><span class="pre">cell_info</span></span><a class="headerlink" href="#elastic_net_modules.data_loading.AdataProcessor.cell_info" title="Link to this definition"></a></dt>
<dd><p>A dictionary containing configuration and parameters for the
cell line.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="elastic_net_modules.data_loading.AdataProcessor.adata">
<span class="sig-name descname"><span class="pre">adata</span></span><a class="headerlink" href="#elastic_net_modules.data_loading.AdataProcessor.adata" title="Link to this definition"></a></dt>
<dd><p>The primary AnnData object for the cell line.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="elastic_net_modules.data_loading.AdataProcessor.phate_coords_obsm_key">
<span class="sig-name descname"><span class="pre">phate_coords_obsm_key</span></span><a class="headerlink" href="#elastic_net_modules.data_loading.AdataProcessor.phate_coords_obsm_key" title="Link to this definition"></a></dt>
<dd><p>The key for PHATE coordinates in <cite>.obsm</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="elastic_net_modules.data_loading.AdataProcessor.phate_params_uns_key">
<span class="sig-name descname"><span class="pre">phate_params_uns_key</span></span><a class="headerlink" href="#elastic_net_modules.data_loading.AdataProcessor.phate_params_uns_key" title="Link to this definition"></a></dt>
<dd><p>The key for PHATE parameters in <cite>.uns</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="elastic_net_modules.data_loading.AdataProcessor.phase_labels_obs_key">
<span class="sig-name descname"><span class="pre">phase_labels_obs_key</span></span><a class="headerlink" href="#elastic_net_modules.data_loading.AdataProcessor.phase_labels_obs_key" title="Link to this definition"></a></dt>
<dd><p>The key for phase labels in <cite>.obs</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="elastic_net_modules.data_loading.AdataProcessor.phase_label_colors_obs_key">
<span class="sig-name descname"><span class="pre">phase_label_colors_obs_key</span></span><a class="headerlink" href="#elastic_net_modules.data_loading.AdataProcessor.phase_label_colors_obs_key" title="Link to this definition"></a></dt>
<dd><p>The key for phase label colors in <cite>.obs</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.data_loading.AdataProcessor.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_line</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimal_cell_lines_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdac_data_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cc_mapping_package_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata_filename_suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'_GMM_DIP.h5ad'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phate_coords_obsm_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'PhateCoords'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phate_params_uns_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'phate_coords_args'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_labels_obs_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'PhaseLabels'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_label_colors_obs_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'PhaseLabelColors'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_set_var_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'in_random_forest_fs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_set_uns_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'random_forest_fs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_forest_fs_name_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'RandomForestFeatureSets'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_forest_fs_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'RandomForestFeatureSet'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/data_loading.html#AdataProcessor.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.data_loading.AdataProcessor.__init__" title="Link to this definition"></a></dt>
<dd><p>Initializes the AdataProcessor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_line</strong> – The name of the cell line.</p></li>
<li><p><strong>optimal_cell_lines_dict</strong> – A dictionary containing configuration for
all cell lines.</p></li>
<li><p><strong>pdac_data_dir</strong> – Path to the PDAC data directory.</p></li>
<li><p><strong>cc_mapping_package_dir</strong> – Path to the cc_mapping package directory.</p></li>
<li><p><strong>adata_filename_suffix</strong> – Suffix for the AnnData filename.</p></li>
<li><p><strong>phate_coords_obsm_key</strong> – Key for PHATE coordinates in <cite>.obsm</cite>.</p></li>
<li><p><strong>phate_params_uns_key</strong> – Key for PHATE parameters in <cite>.uns</cite>.</p></li>
<li><p><strong>phase_labels_obs_key</strong> – Key for phase labels in <cite>.obs</cite>.</p></li>
<li><p><strong>phase_label_colors_obs_key</strong> – Key for phase label colors in <cite>.obs</cite>.</p></li>
<li><p><strong>feature_set_var_key</strong> – Key for the feature set boolean mask in <cite>.var</cite>.</p></li>
<li><p><strong>feature_set_uns_key</strong> – Key for the feature set list in <cite>.uns</cite>.</p></li>
<li><p><strong>random_forest_fs_name_key</strong> – The key for the RF feature set name in
the API results.</p></li>
<li><p><strong>random_forest_fs_key</strong> – The key for the actual feature set in the
API results.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.data_loading.AdataProcessor.add_random_forest_feature_set">
<span class="sig-name descname"><span class="pre">add_random_forest_feature_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_set_var_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_set_uns_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/data_loading.html#AdataProcessor.add_random_forest_feature_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.data_loading.AdataProcessor.add_random_forest_feature_set" title="Link to this definition"></a></dt>
<dd><p>Adds the random forest feature set to .var and .uns.</p>
<p>This method retrieves the list of features from the random forest
feature selection, adds a boolean mask to <cite>.var</cite> indicating which
features are in the set, and stores the list of feature names in <cite>.uns</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_set_var_key</strong> – The key in <cite>.var</cite> for the boolean mask.
If None, <cite>self.feature_set_var_key</cite> is used.</p></li>
<li><p><strong>feature_set_uns_key</strong> – The key in <cite>.uns</cite> for the list of features.
If None, <cite>self.feature_set_uns_key</cite> is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.data_loading.AdataProcessor.add_phate_coordinates">
<span class="sig-name descname"><span class="pre">add_phate_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phate_coords_obsm_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phate_params_uns_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/data_loading.html#AdataProcessor.add_phate_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.data_loading.AdataProcessor.add_phate_coordinates" title="Link to this definition"></a></dt>
<dd><p>Computes and adds PHATE coordinates to the AnnData object.</p>
<p>This method retrieves pre-computed PHATE coordinates, which are based on
a random forest feature set, and adds them to the <cite>.obsm</cite> attribute of
the main AnnData object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phate_coords_obsm_key</strong> – The key in <cite>.obsm</cite> where PHATE coordinates
will be stored. If None, <cite>self.phate_coords_obsm_key</cite> is used.</p></li>
<li><p><strong>phate_params_uns_key</strong> – The key in <cite>.uns</cite> where PHATE parameters
will be stored. If None, <cite>self.phate_params_uns_key</cite> is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.data_loading.AdataProcessor.add_phase_labels">
<span class="sig-name descname"><span class="pre">add_phase_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase_labels_obs_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_label_colors_obs_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/data_loading.html#AdataProcessor.add_phase_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.data_loading.AdataProcessor.add_phase_labels" title="Link to this definition"></a></dt>
<dd><p>Adds cell cycle phase labels and colors to the AnnData object.</p>
<p>This method retrieves pre-computed phase labels and their corresponding
color mappings and adds them to the <cite>.obs</cite> attribute of the main
AnnData object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase_labels_obs_key</strong> – The key in <cite>.obs</cite> for phase labels.
If None, <cite>self.phase_labels_obs_key</cite> is used.</p></li>
<li><p><strong>phase_label_colors_obs_key</strong> – The key in <cite>.obs</cite> for phase label
colors. If None, <cite>self.phase_label_colors_obs_key</cite> is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.data_loading.AdataProcessor.process_all">
<span class="sig-name descname"><span class="pre">process_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AnnData</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/elastic_net_modules/data_loading.html#AdataProcessor.process_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.data_loading.AdataProcessor.process_all" title="Link to this definition"></a></dt>
<dd><p>Runs all data processing steps in the correct order.</p>
<p>This convenience method calls all the individual data-adding methods
to fully process the AnnData object (without Palantir results).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>The main, enriched AnnData object.</p></li>
<li><p>None (placeholder for compatibility with original API).</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-elastic_net_modules.feature_engineering">
<span id="feature-engineering"></span><h2>Feature Engineering<a class="headerlink" href="#module-elastic_net_modules.feature_engineering" title="Link to this heading"></a></h2>
<p>Feature Engineering Module for Elastic Net Analysis</p>
<p>This module handles:
1. Log transformation of protein intensities (for exploration/validation)
2. Generation of all 2^N feature combinations with validation and case-insensitive matching
3. Dynamic computation of 6 composite features for each combination:</p>
<blockquote>
<div><ul class="simple">
<li><p>SUM_GAS: Sum of activator proteins (cycD1, cycE) - NaN if &lt; 2 present</p></li>
<li><p>SUM_BRAKE: Sum of inhibitor proteins (p21, p27) - NaN if &lt; 2 present</p></li>
<li><p>SUM_ENGINES: Sum of engine proteins (CDK2, CDK4, CDK6) - NaN if &lt; 2 present</p></li>
<li><p>GAS_BRAKE_RATIO: SUM_GAS - SUM_BRAKE (log-space difference) - NaN if either is NaN</p></li>
<li><p>SUM_ACTIVATED_ENGINE: Sum of biologically valid cyclin-CDK products - NaN if &lt; 1 complex</p></li>
<li><p>ACT_ENGINE_BRAKE_RATIO: SUM_ACTIVATED_ENGINE - BRAKE - NaN if no complexes or brakes</p></li>
</ul>
</div></blockquote>
<p>Key Design Principles:
- log_transform_features(): Available for exploratory analysis and validation notebooks
- In nested CV (Phase 1.2): Log transform happens INSIDE the CV loop to prevent data leakage
- generate_all_feature_combinations(): Case-insensitive validation, preserves user’s naming convention
- compute_composite_features(): Expects Z-SCORED data as input (mean≈0, std≈1)
- Z-scoring is done per fold in nested CV (train scaler fit on train data only)
- NaN handling: Composites return NaN when &lt; 2 components (not meaningful sums)</p>
<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.feature_engineering.log_transform_features">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.feature_engineering.</span></span><span class="sig-name descname"><span class="pre">log_transform_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">protein_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'log_transformed'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudocount</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-100</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/feature_engineering.html#log_transform_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.feature_engineering.log_transform_features" title="Link to this definition"></a></dt>
<dd><p>Apply log10 transformation to raw protein intensities.</p>
<p>This is the first step in feature engineering. Raw protein intensities
are typically highly skewed and need log transformation for:
1. Normalization of distributions
2. Stabilization of variance
3. Biological interpretability (fold changes become linear)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – Single-cell data object with raw protein intensities in .X or a layer</p></li>
<li><p><strong>protein_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – List of protein names to transform (e.g., [‘CycD1’, ‘CycE’, ‘p21’, …])</p></li>
<li><p><strong>layer_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Name for the new layer to store log-transformed data (default: ‘log_transformed’)</p></li>
<li><p><strong>pseudocount</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Minimal safety value added before log transform (default: 1e-100)
Data should already be filtered to remove zeros; this is just protection</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Modifies adata in-place by adding a new layer</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Data should already be filtered to remove zeros before calling this function</p></li>
<li><p>Minimal pseudocount (1e-100) added as safety net without distorting data</p></li>
<li><p>Uses log10 (base 10) for interpretability</p></li>
<li><p>Stores result in adata.layers[layer_name]</p></li>
<li><p>Original data in adata.X is NOT modified</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">anndata</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ad</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create mock data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adata</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">AnnData</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">7</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adata</span><span class="o">.</span><span class="n">var_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CycD1&#39;</span><span class="p">,</span> <span class="s1">&#39;CycE&#39;</span><span class="p">,</span> <span class="s1">&#39;p21&#39;</span><span class="p">,</span> <span class="s1">&#39;p27&#39;</span><span class="p">,</span> <span class="s1">&#39;CDK2&#39;</span><span class="p">,</span> <span class="s1">&#39;CDK4&#39;</span><span class="p">,</span> <span class="s1">&#39;CDK6&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_transform_features</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">adata</span><span class="o">.</span><span class="n">var_names</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>  <span class="c1"># dict_keys([&#39;log_transformed&#39;])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.feature_engineering.generate_all_feature_combinations">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.feature_engineering.</span></span><span class="sig-name descname"><span class="pre">generate_all_feature_combinations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">activators</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inhibitors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">engines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/elastic_net_modules/feature_engineering.html#generate_all_feature_combinations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.feature_engineering.generate_all_feature_combinations" title="Link to this definition"></a></dt>
<dd><p>Generate all 2^N combinations of activators, inhibitors, and engines.</p>
<p>This creates every possible subset of the N cell cycle proteins, ranging from
the empty set (0 proteins) to the full set (all N proteins). Each combination
becomes a candidate feature set for model evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>activators</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – List of activator proteins (GAS), e.g., [‘cycE’, ‘cycD1’].
Must contain only cyclins: CycD1/cycD1 or CycE/cycE (case-insensitive).
Pass empty list [] to skip validation (for future extensibility).</p></li>
<li><p><strong>inhibitors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – List of inhibitor proteins (BRAKE), e.g., [‘p21’, ‘p27’].
Must contain only known inhibitors: p21, p27 (case-insensitive).
Pass empty list [] to skip validation (for future extensibility).</p></li>
<li><p><strong>engines</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – List of engine proteins (CDKs), e.g., [‘CDK2’, ‘CDK4’, ‘CDK6’].
Must contain only known CDKs: CDK2, CDK4, CDK6 (case-insensitive).
Pass empty list [] to skip validation (for future extensibility).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>combinations</strong> – Each dict contains:
- ‘features’: list of protein names in this combination
- ‘gas’: subset of activators in this combination
- ‘brakes’: subset of inhibitors in this combination
- ‘engine’: subset of engine proteins in this combination
- ‘name’: human-readable name (e.g., “cycD1_CDK4_p27”)
- ‘id’: unique integer ID (0 to 2^N-1)
- ‘n_features’: number of base proteins (before adding composites)
- ‘valid_complexes’: list of tuples describing valid cyclin-CDK pairs</p>
<blockquote>
<div><p>Example: [(‘cycD1’, [‘CDK4’, ‘CDK6’]), (‘cycE’, [‘CDK2’])]</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If any protein name doesn’t match expected cell cycle proteins (case-insensitive).
    Empty lists are allowed and skip validation.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Expected proteins (case-insensitive):
- GAS (activators): CycD1, CycE
- BRAKE (inhibitors): p21, p27
- ENGINE (catalysts): CDK2, CDK4, CDK6</p>
<p>Biologically Valid Cyclin-CDK Complexes:
- ✅ CycD1-CDK4 (G1 phase progression)
- ✅ CycD1-CDK6 (G1 phase progression, alternative to CDK4)
- ✅ CycE-CDK2 (G1/S transition)</p>
<p>Invalid pairings (NOT computed):
- ❌ CycD1-CDK2 (not a natural complex)
- ❌ CycE-CDK4 (not a natural complex)
- ❌ CycE-CDK6 (not a natural complex)</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Standard usage with lowercase names</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combos</span> <span class="o">=</span> <span class="n">generate_all_feature_combinations</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">activators</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cycE&#39;</span><span class="p">,</span> <span class="s1">&#39;cycD1&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">inhibitors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p21&#39;</span><span class="p">,</span> <span class="s1">&#39;p27&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">engines</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CDK2&#39;</span><span class="p">,</span> <span class="s1">&#39;CDK4&#39;</span><span class="p">,</span> <span class="s1">&#39;CDK6&#39;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">combos</span><span class="p">)</span>
<span class="go">128</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Empty set (model 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">{&#39;features&#39;: [], &#39;gas&#39;: [], &#39;brakes&#39;: [], &#39;engine&#39;: [], &#39;name&#39;: &#39;empty&#39;, &#39;id&#39;: 0, ...}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Full set (model 127)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combos</span><span class="p">[</span><span class="mi">127</span><span class="p">][</span><span class="s1">&#39;features&#39;</span><span class="p">]</span>
<span class="go">[&#39;cycE&#39;, &#39;cycD1&#39;, &#39;p21&#39;, &#39;p27&#39;, &#39;CDK2&#39;, &#39;CDK4&#39;, &#39;CDK6&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example with valid complexes (case preserved from input)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combo</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">combos</span> <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;cycD1&#39;</span><span class="p">,</span> <span class="s1">&#39;CDK4&#39;</span><span class="p">,</span> <span class="s1">&#39;p27&#39;</span><span class="p">}][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">combo</span><span class="p">[</span><span class="s1">&#39;valid_complexes&#39;</span><span class="p">]</span>
<span class="go">[(&#39;cycD1&#39;, [&#39;CDK4&#39;])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.feature_engineering.logsumexp10">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.feature_engineering.</span></span><span class="sig-name descname"><span class="pre">logsumexp10</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/feature_engineering.html#logsumexp10"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.feature_engineering.logsumexp10" title="Link to this definition"></a></dt>
<dd><p>Calculate log10(sum(10^values)) for LogSumExp in base 10.</p>
<p>This helper converts Z-scores (which represent log10 abundances) back to
linear space, sums them, then converts back to log10 space.</p>
<p>Mathematical relationship:
- If Z = log10(abundance), then abundance = 10^Z
- Sum of abundances = 10^Z1 + 10^Z2 + …
- Log10 of sum = log10(10^Z1 + 10^Z2 + …)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>values</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> or </em><em>array-like</em>) – List of values in log10 space (Z-scores)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result</strong> – log10(sum(10^values))</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a> or np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses np.logaddexp for numerical stability to avoid overflow/underflow.
Works with both single values and arrays of values.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logsumexp10</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>  <span class="c1"># log10(10 + 100) = log10(110) ≈ 2.041</span>
<span class="go">2.0413926851582251</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logsumexp10</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># log10(1 + 1) = log10(2) ≈ 0.301</span>
<span class="go">0.3010299956639812</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.feature_engineering.compute_composite_features">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.feature_engineering.</span></span><span class="sig-name descname"><span class="pre">compute_composite_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_base</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_set_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/elastic_net_modules/feature_engineering.html#compute_composite_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.feature_engineering.compute_composite_features" title="Link to this definition"></a></dt>
<dd><p>Compute GAS, BRAKE, ENGINES, GAS_BRAKE_RATIO, ACTIVATED_ENGINE, and ACT_ENGINE_BRAKE_RATIO features.</p>
<p>This is the core innovation of the pipeline. For EACH of the 128 feature sets,
we dynamically calculate 6 composite features based on which proteins are present.
These composites capture biological relationships and improve interpretability.</p>
<p>CRITICAL: This function expects X_base to be ALREADY Z-SCORE NORMALIZED.
Composite features are computed on Z-scores, not raw values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_base</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_cells</em><em>, </em><em>n_features</em><em>)</em>) – Log-transformed, Z-score normalized features for selected proteins
MUST be Z-score normalized before calling this function!</p></li>
<li><p><strong>feature_set_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Configuration dict from generate_all_feature_combinations()
Must contain keys: ‘gas’, ‘brakes’, ‘engine’, ‘valid_complexes’, ‘features’</p></li>
<li><p><strong>feature_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Names of features in X_base (must match feature_set_config[‘features’])</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><strong>X_augmented</strong> (<em>np.ndarray, shape (n_cells, n_features + 5)</em>) – Original features plus [GAS, BRAKE, GAS_BRAKE_RATIO, ACTIVATED_ENGINE, ACT_ENGINE_BRAKE_RATIO]</p></li>
<li><p><strong>feature_names_augmented</strong> (<em>list of str</em>) – Names of all features in X_augmented</p></li>
<li><p><em>Composite Feature Definitions (All Computed on Z-Scores)</em></p></li>
<li><p><em>———————————————————</em></p></li>
<li><p><strong>1. **SUM_GAS**</strong> (<em>Log10 of sum of activator proteins (CycD1, CycE)</em>) –</p>
<ul class="simple">
<li><p>Uses LogSumExp on Z-scores to approximate log(sum(abundance))</p></li>
<li><p>If &lt; 2 GAS proteins: SUM_GAS = NaN (not a meaningful sum)</p></li>
</ul>
</li>
<li><p><strong>2. **SUM_BRAKE**</strong> (<em>Log10 of sum of inhibitor proteins (p21, p27)</em>) –</p>
<ul class="simple">
<li><p>Uses LogSumExp on Z-scores</p></li>
<li><p>If &lt; 2 BRAKE proteins: SUM_BRAKE = NaN (not a meaningful sum)</p></li>
</ul>
</li>
<li><p><strong>3. **SUM_ENGINES**</strong> (<em>Log10 of sum of engine proteins (CDK2, CDK4, CDK6)</em>) –</p>
<ul class="simple">
<li><p>Uses LogSumExp on Z-scores</p></li>
<li><p>If &lt; 2 ENGINE proteins: SUM_ENGINES = NaN</p></li>
</ul>
</li>
<li><p><strong>4. **GAS_BRAKE_RATIO**</strong> (<em>GAS - BRAKE (allows individual proteins or sums)</em>) –</p>
<ul class="simple">
<li><p>If ≥1 gas AND ≥1 brake: GAS_BRAKE_RATIO = (sum of gas proteins) - (sum of brake proteins)</p></li>
<li><p>If 0 gas OR 0 brake: GAS_BRAKE_RATIO = NaN</p></li>
<li><p>Captures the fundamental “Gas vs Brakes” concept at any scale</p></li>
</ul>
</li>
<li><p><strong>5. **SUM_ACTIVATED_ENGINE**</strong> (<em>Log10 of sum of biologically valid cyclin-CDK products</em>) –</p>
<ul class="simple">
<li><p>Complex formation (Mass Action): [Complex] ∝ [Cyclin] * [CDK]</p></li>
<li><p>In Log/Z-score space: Z(Complex) = Z(Cyclin) + Z(CDK)</p></li>
<li><p>Total Activated Engine = LogSumExp(Z(Complex_1), Z(Complex_2), …)</p></li>
<li><p>If &lt; 1 valid complex: SUM_ACTIVATED_ENGINE = NaN</p></li>
</ul>
<p>Examples:
- {CycD1, CDK4} → Z(CycD1) + Z(CDK4) (1 complex)
- {CycD1, CDK4, CDK6} → LogSumExp( Z(CycD1)+Z(CDK4), Z(CycD1)+Z(CDK6) )</p>
</li>
<li><p><strong>6. **ACT_ENGINE_BRAKE_RATIO**</strong> (<em>SUM_ACTIVATED_ENGINE - BRAKE (allows individual brakes)</em>) –</p>
<ul class="simple">
<li><p>If ≥1 valid complex AND ≥1 brake: ACT_ENGINE_BRAKE_RATIO = SUM_ACTIVATED_ENGINE - (sum of brakes)</p></li>
<li><p>If 0 complexes OR 0 brakes: ACT_ENGINE_BRAKE_RATIO = NaN</p></li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.feature_engineering.print_feature_set_summary">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.feature_engineering.</span></span><span class="sig-name descname"><span class="pre">print_feature_set_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_set_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_sets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/feature_engineering.html#print_feature_set_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.feature_engineering.print_feature_set_summary" title="Link to this definition"></a></dt>
<dd><p>Pretty-print summary of feature set configurations.</p>
<p>Useful for visual validation and understanding what each model contains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_set_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Single config or list of configs from generate_all_feature_combinations()</p></li>
<li><p><strong>max_sets</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Maximum number of sets to print (default: 10)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">combos</span> <span class="o">=</span> <span class="n">generate_all_feature_combinations</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_feature_set_summary</span><span class="p">(</span><span class="n">combos</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-elastic_net_modules.preprocessing">
<span id="preprocessing"></span><h2>Preprocessing<a class="headerlink" href="#module-elastic_net_modules.preprocessing" title="Link to this heading"></a></h2>
<p>Preprocessing Module for Elastic Net Analysis</p>
<p>This module handles all data preparation steps before Elastic Net modeling:
1. DNA content labeling (manual threshold or GMM: 2N vs not_2N)
2. Proliferation labeling (manual threshold or GMM: prolif vs nonprolif)
3. Optional percentile-based filtering (e.g., Fra1 low cells)
4. Ploidy filtering (optional 2N selection)
5. Feature extraction</p>
<p>Author: Stallaert Lab
Date: November 13, 2025</p>
<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.preprocessing.label_ploidy_and_proliferation">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.preprocessing.</span></span><span class="sig-name descname"><span class="pre">label_ploidy_and_proliferation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dna_feature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'norm_Int_Intg_DNA_nuc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prolif_marker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('Int_Med_pRB_nuc',</span> <span class="pre">'Int_Med_RB_nuc')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ploidy_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prolif_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmm_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_line</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_histograms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><span class="pre">ElasticNetResultsManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/preprocessing.html#label_ploidy_and_proliferation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.preprocessing.label_ploidy_and_proliferation" title="Link to this definition"></a></dt>
<dd><p>Label ALL cells for ploidy and proliferation status.</p>
<p>Supports both manual thresholds and GMM-based labeling using cc-mapping.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – Single-cell data object with raw measurements</p></li>
<li><p><strong>dna_feature</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Feature name for DNA content</p></li>
<li><p><strong>prolif_marker</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – (numerator, denominator) for proliferation ratio</p></li>
<li><p><strong>ploidy_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> or </em><em>None</em>) – <p>Configuration for ploidy labeling:
{</p>
<blockquote>
<div><p>’enabled’: bool (default True),
‘use_manual’: bool (default False),
‘manual_threshold’: float (if use_manual=True),
‘manual_labels’: list (if use_manual=True),
‘n_components’: int (if use_manual=False),
‘ordered_labels’: list (if use_manual=False),
‘save_histogram’: bool (default True)</p>
</div></blockquote>
<p>}</p>
</p></li>
<li><p><strong>prolif_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> or </em><em>None</em>) – <p>Configuration for proliferation labeling:
{</p>
<blockquote>
<div><p>’use_manual’: bool (default False),
‘manual_threshold’: float (if use_manual=True),
‘manual_labels’: list (if use_manual=True),
‘n_components’: int (if use_manual=False),
‘ordered_labels’: list (if use_manual=False),
‘save_histogram’: bool (default True)</p>
</div></blockquote>
<p>}</p>
</p></li>
<li><p><strong>gmm_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> or </em><em>None</em>) – Keyword arguments for GaussianMixture (only used for GMM mode)</p></li>
<li><p><strong>output_dir</strong> (<em>Path</em><em> or </em><em>None</em>) – Directory to save histograms</p></li>
<li><p><strong>cell_line</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>None</em>) – Cell line name for plot titles</p></li>
<li><p><strong>save_histograms</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Master switch for saving histograms</p></li>
<li><p><strong>results_manager</strong> (<a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><em>ElasticNetResultsManager</em></a><em> or </em><em>None</em>) – If provided, saves histograms through manager</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>adata</strong> – Input adata with new columns in .obs:
- ‘ploidy_label’: int (0=not_2N, 1=2N)
- ‘ploidy_label_str’: str (‘not_2N’, ‘2N’)
- ‘prolif_label’: int (0=nonprolif, 1=prolif)
- ‘prolif_label_str’: str (‘nonprolif’, ‘prolif’)
- ‘prolif_marker_log’: float (log10 pRB/RB ratio)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>AnnData</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.preprocessing.label_ploidy_and_proliferation_gmm">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.preprocessing.</span></span><span class="sig-name descname"><span class="pre">label_ploidy_and_proliferation_gmm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dna_feature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'norm_Int_Intg_DNA_nuc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prolif_marker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('Int_Med_pRB_nuc',</span> <span class="pre">'Int_Med_RB_nuc')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ploidy_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prolif_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmm_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_line</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_histograms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><span class="pre">ElasticNetResultsManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#elastic_net_modules.preprocessing.label_ploidy_and_proliferation_gmm" title="Link to this definition"></a></dt>
<dd><p>Label ALL cells for ploidy and proliferation status.</p>
<p>Supports both manual thresholds and GMM-based labeling using cc-mapping.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – Single-cell data object with raw measurements</p></li>
<li><p><strong>dna_feature</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Feature name for DNA content</p></li>
<li><p><strong>prolif_marker</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – (numerator, denominator) for proliferation ratio</p></li>
<li><p><strong>ploidy_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> or </em><em>None</em>) – <p>Configuration for ploidy labeling:
{</p>
<blockquote>
<div><p>’enabled’: bool (default True),
‘use_manual’: bool (default False),
‘manual_threshold’: float (if use_manual=True),
‘manual_labels’: list (if use_manual=True),
‘n_components’: int (if use_manual=False),
‘ordered_labels’: list (if use_manual=False),
‘save_histogram’: bool (default True)</p>
</div></blockquote>
<p>}</p>
</p></li>
<li><p><strong>prolif_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> or </em><em>None</em>) – <p>Configuration for proliferation labeling:
{</p>
<blockquote>
<div><p>’use_manual’: bool (default False),
‘manual_threshold’: float (if use_manual=True),
‘manual_labels’: list (if use_manual=True),
‘n_components’: int (if use_manual=False),
‘ordered_labels’: list (if use_manual=False),
‘save_histogram’: bool (default True)</p>
</div></blockquote>
<p>}</p>
</p></li>
<li><p><strong>gmm_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> or </em><em>None</em>) – Keyword arguments for GaussianMixture (only used for GMM mode)</p></li>
<li><p><strong>output_dir</strong> (<em>Path</em><em> or </em><em>None</em>) – Directory to save histograms</p></li>
<li><p><strong>cell_line</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>None</em>) – Cell line name for plot titles</p></li>
<li><p><strong>save_histograms</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Master switch for saving histograms</p></li>
<li><p><strong>results_manager</strong> (<a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><em>ElasticNetResultsManager</em></a><em> or </em><em>None</em>) – If provided, saves histograms through manager</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>adata</strong> – Input adata with new columns in .obs:
- ‘ploidy_label’: int (0=not_2N, 1=2N)
- ‘ploidy_label_str’: str (‘not_2N’, ‘2N’)
- ‘prolif_label’: int (0=nonprolif, 1=prolif)
- ‘prolif_label_str’: str (‘nonprolif’, ‘prolif’)
- ‘prolif_marker_log’: float (log10 pRB/RB ratio)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>AnnData</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.preprocessing.apply_percentile_filter_from_subset">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.preprocessing.</span></span><span class="sig-name descname"><span class="pre">apply_percentile_filter_from_subset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">operator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_subset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_label_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset_label_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/preprocessing.html#apply_percentile_filter_from_subset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.preprocessing.apply_percentile_filter_from_subset" title="Link to this definition"></a></dt>
<dd><p>Filter cells based on percentile threshold calculated from a reference subset.</p>
<p>This implements the Fra1-filtering logic:
1. Calculate threshold from a chosen subset (e.g., nonprolif cells)
2. Apply threshold to ALL cells</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – Data to filter</p></li>
<li><p><strong>feature</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Feature name to filter on (e.g., ‘Int_Med_Fra1_nuc’)</p></li>
<li><p><strong>percentile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Percentile value (0-100)</p></li>
<li><p><strong>operator</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Comparison operator: ‘lt’, ‘le’, ‘gt’, ‘ge’, ‘eq’, ‘ne’
Default: ‘lt’ (less than, for “keep low Fra1 cells”)</p></li>
<li><p><strong>reference_subset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Which cells to use for calculating threshold:
- ‘all’: All cells
- ‘nonprolif’: Nonprolif cells only
- ‘prolif’: Prolif cells only
- ‘2N’: 2N cells only
Note: If filter_2n=True was applied first, these are implicitly 2N cells</p></li>
<li><p><strong>subset_label_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>None</em>) – Column in adata.obs with labels (e.g., ‘prolif_label’)
Required if reference_subset is ‘nonprolif’ or ‘prolif’</p></li>
<li><p><strong>subset_label_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> or </em><em>None</em>) – Value in subset_label_key for the reference subset
- 0 for nonprolif
- 1 for prolif</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><strong>adata_filtered</strong> (<em>AnnData</em>) – Filtered cells</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – The threshold value used</p></li>
<li><p><strong>filter_info</strong> (<em>dict</em>) – Metadata about filtering:
{</p>
<blockquote>
<div><p>’feature’: str,
‘percentile’: float,
‘threshold’: float,
‘operator’: str,
‘reference_subset’: str,
‘n_reference_cells’: int,
‘n_cells_before’: int,
‘n_cells_after’: int,
‘n_cells_removed’: int,
‘fraction_removed’: float</p>
</div></blockquote>
<p>}</p>
</li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Keep cells with Fra1 &lt; P90 of nonprolif cells</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adata_filt</span><span class="p">,</span> <span class="n">thresh</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">apply_percentile_filter_from_subset</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">adata</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">feature</span><span class="o">=</span><span class="s1">&#39;Int_Med_Fra1_nuc&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">percentile</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">operator</span><span class="o">=</span><span class="s1">&#39;lt&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">reference_subset</span><span class="o">=</span><span class="s1">&#39;nonprolif&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">subset_label_key</span><span class="o">=</span><span class="s1">&#39;prolif_label&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">subset_label_value</span><span class="o">=</span><span class="mi">0</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.preprocessing.prepare_data_for_elastic_net">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.preprocessing.</span></span><span class="sig-name descname"><span class="pre">prepare_data_for_elastic_net</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_2n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optional_filter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">protein_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_conditions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><span class="pre">ElasticNetResultsManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/preprocessing.html#prepare_data_for_elastic_net"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.preprocessing.prepare_data_for_elastic_net" title="Link to this definition"></a></dt>
<dd><p>Prepare data for Elastic Net analysis (Stage 2 preprocessing).</p>
<p>This function assumes adata already has GMM labels from label_ploidy_and_proliferation_gmm().</p>
<p>Pipeline:
1. Exclude specified conditions (optional)
2. Filter to 2N cells (optional, recommended)
3. Apply percentile-based filter (optional, e.g., Fra1)
4. Extract specified proteins</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – Data with GMM labels already applied (from label_ploidy_and_proliferation_gmm)
Must have columns: ‘ploidy_label’, ‘prolif_label’</p></li>
<li><p><strong>filter_2n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – If True, keep only 2N cells (default True)</p></li>
<li><p><strong>optional_filter</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> or </em><em>None</em>) – <p>Percentile filter configuration:
{</p>
<blockquote>
<div><p>’enabled’: bool,
‘feature’: str (e.g., ‘Int_Med_Fra1_nuc’),
‘operator’: str (‘lt’, ‘le’, ‘gt’, ‘ge’),
‘percentile’: float (0-100),
‘reference_subset’: str (‘all’, ‘nonprolif’, ‘prolif’, ‘2N’),
‘subset_label_key’: str (e.g., ‘prolif_label’),
‘subset_label_value’: int (e.g., 0 for nonprolif)</p>
</div></blockquote>
<p>}</p>
</p></li>
<li><p><strong>protein_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>None</em>) – Proteins to extract (e.g., [‘CycD1’, ‘CycE’, ‘p21’, ‘p27’, ‘CDK2’, ‘CDK4’, ‘CDK6’])
If None, extracts all proteins in .X</p></li>
<li><p><strong>exclude_conditions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>None</em>) – Conditions to exclude (e.g., [‘ERK2000’])</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Print progress information (default True)</p></li>
<li><p><strong>results_manager</strong> (<a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><em>ElasticNetResultsManager</em></a><em> or </em><em>None</em>) – If provided, saves preprocessing info to manager.add_preprocessing_info()</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><strong>adata_processed</strong> (<em>AnnData</em>) – Processed data ready for Elastic Net:
- Filtered by ploidy, optional filter
- Contains only specified proteins in .X (raw intensities)
- Has ‘prolif_label’ column (binary: 0=nonprolif, 1=prolif)</p></li>
<li><p><strong>preprocessing_info</strong> (<em>dict</em>) – Metadata about preprocessing steps:
{</p>
<blockquote>
<div><p>’n_cells_original’: int,
‘n_cells_after_condition_filter’: int,
‘n_cells_after_2n_filter’: int,
‘n_cells_after_optional_filter’: int,
‘n_cells_final’: int,
‘filter_2n_applied’: bool,
‘optional_filter_applied’: bool,
‘optional_filter_info’: dict or None,
‘excluded_conditions’: list,
‘protein_list’: list,
‘prolif_distribution’: dict,  # {0: count, 1: count}
‘prolif_distribution_pct’: dict  # {0: pct, 1: pct}</p>
</div></blockquote>
<p>}</p>
</li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># With results manager (recommended for full workflow)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span> <span class="o">=</span> <span class="n">ElasticNetResultsManager</span><span class="p">(</span><span class="n">cell_line</span><span class="o">=</span><span class="s1">&#39;CFPAC&#39;</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="s1">&#39;control&#39;</span><span class="p">,</span> <span class="n">additional_info</span><span class="o">=</span><span class="s1">&#39;g0g1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adata_prep</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">prepare_data_for_elastic_net</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">adata</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">filter_2n</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">optional_filter</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">protein_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CycD1&#39;</span><span class="p">,</span> <span class="s1">&#39;CycE&#39;</span><span class="p">,</span> <span class="s1">&#39;p21&#39;</span><span class="p">,</span> <span class="s1">&#39;p27&#39;</span><span class="p">,</span> <span class="s1">&#39;CDK2&#39;</span><span class="p">,</span> <span class="s1">&#39;CDK4&#39;</span><span class="p">,</span> <span class="s1">&#39;CDK6&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">results_manager</span><span class="o">=</span><span class="n">manager</span>  <span class="c1"># Auto-saves preprocessing info</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Without manager (manual exploration)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adata_prep</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">prepare_data_for_elastic_net</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">adata</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">filter_2n</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">protein_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CycD1&#39;</span><span class="p">,</span> <span class="s1">&#39;CycE&#39;</span><span class="p">,</span> <span class="s1">&#39;p21&#39;</span><span class="p">,</span> <span class="s1">&#39;p27&#39;</span><span class="p">,</span> <span class="s1">&#39;CDK2&#39;</span><span class="p">,</span> <span class="s1">&#39;CDK4&#39;</span><span class="p">,</span> <span class="s1">&#39;CDK6&#39;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Step 3: Run Elastic Net</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_raw</span> <span class="o">=</span> <span class="n">adata_prep</span><span class="o">.</span><span class="n">X</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">adata_prep</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;prolif_label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">evaluate_all_feature_sets</span><span class="p">(</span><span class="n">adata_prep</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-elastic_net_modules.nested_cv">
<span id="nested-cross-validation"></span><h2>Nested Cross-Validation<a class="headerlink" href="#module-elastic_net_modules.nested_cv" title="Link to this heading"></a></h2>
<p>Nested Cross-Validation Module for Elastic Net Analysis</p>
<p>This module implements nested cross-validation for unbiased performance estimation.</p>
<p>Key Features:
- Outer loop: RepeatedStratifiedKFold for performance estimation
- Inner loop: GridSearchCV for hyperparameter tuning
- Proper data flow to prevent leakage: raw → log → Z-score → composites → clean
- NaN handling: Remove features with all NaN, then samples with any NaN
- Error handling: Graceful warnings for edge cases, continues analysis</p>
<p>Critical Design:
- Purpose: Performance estimation ONLY (mean AUROC ± SE)
- No model saving: We’ll redo hyperparameter search on full data later
- Prevents leakage: Test data uses train scaler statistics</p>
<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.nested_cv.nested_cv_single_feature_set">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.nested_cv.</span></span><span class="sig-name descname"><span class="pre">nested_cv_single_feature_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_set_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer_cv_splits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer_cv_repeats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_cv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_fold_models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_composite_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/nested_cv.html#nested_cv_single_feature_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.nested_cv.nested_cv_single_feature_set" title="Link to this definition"></a></dt>
<dd><p>Perform nested cross-validation for a single feature set.</p>
<p>This function provides unbiased performance estimates by using nested CV:
- Outer loop: Splits data for performance estimation
- Inner loop: Tunes hyperparameters on training data only</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – Single-cell data object with RAW protein intensities in .X
Function will extract only the proteins needed for this feature set</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_cells</em><em>,</em><em>)</em>) – Binary labels (0 = non-proliferative, 1 = proliferative)</p></li>
<li><p><strong>feature_set_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Configuration from generate_all_feature_combinations()
Must contain ‘features’ key with list of protein names</p></li>
<li><p><strong>param_grid</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Hyperparameters to search for Elastic Net:
Default: {‘l1_ratio’: [0.1, 0.3, 0.5, 0.7, 0.9], ‘C’: [0.1, 1.0, 10.0, 100.0]}
- l1_ratio: Mix of L1/L2 penalty (0=Ridge, 1=Lasso, 0.5=equal mix)
- C: Inverse regularization strength (smaller = more regularization)</p></li>
<li><p><strong>outer_cv_splits</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of splits for RepeatedStratifiedKFold outer loop (default 10)
This determines the train/test split size: test_size = 1/outer_cv_splits
For example: outer_cv_splits=10 → 90% train / 10% test per fold</p></li>
<li><p><strong>outer_cv_repeats</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of repeats for RepeatedStratifiedKFold outer loop (default 1)
Total outer folds = outer_cv_splits × outer_cv_repeats</p></li>
<li><p><strong>inner_cv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of inner CV folds for GridSearchCV (default 5)</p></li>
<li><p><strong>random_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Random seed for reproducibility</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Print progress information (outer fold progress)</p></li>
<li><p><strong>return_fold_models</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – If True, return trained models from each fold (for coefficient stability checks)
If False, discard models after evaluation (saves memory, default)
WARNING: Setting to True increases memory usage significantly</p></li>
<li><p><strong>use_composite_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Legacy parameter. If True, equivalent to feature_mode=’mixed’.
If False, equivalent to feature_mode=’base’.
Ignored if feature_mode is explicitly provided.</p></li>
<li><p><strong>feature_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Determines which features are used for the model:
- ‘base’: Use only base protein features (no composites)
- ‘mixed’: Use base proteins + composite features (default behavior)
- ‘composite’: Use ONLY composite features (drop base proteins)
If None, inferred from use_composite_features.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>results</strong> –</p>
<dl>
<dt>{</dt><dd><p>‘mean_auroc’: float (NaN if all folds failed),
‘se_auroc’: float,  # Standard error of AUROC across outer folds
‘fold_scores’: list of float,  # AUROC for each outer fold
‘feature_set_config’: dict,  # For reference
‘n_features’: int,  # Average features after NaN removal
‘warnings’: list of str,  # Any warnings from folds
‘fold_models’: list of dict (only if return_fold_models=True)</p>
<blockquote>
<div><p>Each dict contains:
{</p>
<blockquote>
<div><p>’model’: LogisticRegression,  # Trained model from this fold
‘scaler’: StandardScaler,  # Fitted scaler from this fold
‘feature_names’: list of str,  # Features used (after NaN removal)
‘best_params’: dict,  # Hyperparameters selected by inner CV
‘fold_idx’: int  # Fold number</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
</dd>
</dl>
<p>}</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Critical for preventing data leakage:
1. Raw data split first (outer fold)
2. Log transform applied to train and test separately
3. StandardScaler fit ONLY on train log data
4. Test log data transformed using TRAIN scaler statistics
5. Composites computed on Z-scored data (separately for train/test)
6. NaN removal done after composites (columns, then rows)
7. Inner GridSearchCV sees only clean train data</p>
<p>This function is for PERFORMANCE ESTIMATION only. After finding the best
feature set via 1-SE rule, we’ll redo hyperparameter search on 100% of data.</p>
</dd></dl>

</section>
<section id="module-elastic_net_modules.results_manager">
<span id="results-management"></span><h2>Results Management<a class="headerlink" href="#module-elastic_net_modules.results_manager" title="Link to this heading"></a></h2>
<p>Results Organization &amp; Management for Elastic Net Analysis</p>
<p>This module provides tools for organizing and tracking Elastic Net analysis outputs.
Creates unique analysis identifiers and manages all results in structured directories.</p>
<section id="key-features">
<h3>Key Features:<a class="headerlink" href="#key-features" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Unique analysis IDs (never overwrite previous runs)</p></li>
<li><p>Automatic directory structure creation</p></li>
<li><p>Metadata tracking (who, what, when, how)</p></li>
<li><p>Dual-format saving (CSV + PKL)</p></li>
<li><p>Integrated plot management</p></li>
<li><p>README generation for human readability</p></li>
</ul>
</section>
<section id="typical-usage-flow">
<h3>Typical Usage Flow:<a class="headerlink" href="#typical-usage-flow" title="Link to this heading"></a></h3>
<p># Simple case - just cell line and condition
manager = ElasticNetResultsManager(</p>
<blockquote>
<div><p>cell_line=”CFPAC”,
condition=”control”</p>
</div></blockquote>
<p>)
# → analysis_id: “CFPAC_control_20251113_142315”</p>
<p># With additional info (e.g., cell cycle phase, treatment time)
manager = ElasticNetResultsManager(</p>
<blockquote>
<div><p>cell_line=”HPAC”,
condition=”ERK2000”,
additional_info=”g0g1”</p>
</div></blockquote>
<p>)
# → analysis_id: “HPAC_ERK2000_g0g1_20251113_150430”</p>
<p># Double loop example (automated batch processing)
for cell_line in [‘CFPAC’, ‘HPAC’, ‘BxPC3’]:</p>
<blockquote>
<div><dl>
<dt>for condition in [‘control’, ‘ERK2000’, ‘ERK5000’]:</dt><dd><p># Optional: Add filtering info
additional_info = “g0g1_filtered” if filter_2n else “allcells”</p>
<dl class="simple">
<dt>manager = ElasticNetResultsManager(</dt><dd><p>cell_line=cell_line,
condition=condition,
additional_info=additional_info</p>
</dd>
</dl>
<p>)</p>
<p># Run full analysis…
# All results automatically organized by manager</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="classes">
<h3>Classes:<a class="headerlink" href="#classes" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>ElasticNetResultsManager: Main class for managing analysis outputs</p></li>
</ul>
</section>
<section id="functions">
<h3>Functions:<a class="headerlink" href="#functions" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>generate_analysis_id: Create unique identifier for analysis run</p></li>
</ul>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.generate_analysis_id">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.results_manager.</span></span><span class="sig-name descname"><span class="pre">generate_analysis_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_line</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/results_manager.html#generate_analysis_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.results_manager.generate_analysis_id" title="Link to this definition"></a></dt>
<dd><p>Generate unique identifier for analysis run.</p>
<dl class="simple">
<dt>Format:</dt><dd><ul class="simple">
<li><p>With additional_info: {cell_line}_{condition}_{additional_info}_{timestamp}</p></li>
<li><p>Without: {cell_line}_{condition}_{timestamp}</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_line</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Cell line name (e.g., ‘CFPAC’, ‘HPAC’, ‘Pa02C’)
Automatically converted to safe format (alphanumeric + underscores)</p></li>
<li><p><strong>condition</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Experimental condition (e.g., ‘control’, ‘ERK2000’, ‘Fra1_KD’)
Automatically converted to safe format</p></li>
<li><p><strong>additional_info</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Optional additional descriptor (e.g., ‘g0g1’, ‘nonprolif’, ‘allcells’, ‘48h’)
If None, omitted from ID
Automatically converted to safe format</p></li>
<li><p><strong>timestamp</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Timestamp in format YYYYMMDD_HHMMSS
If None, auto-generated from current time</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>analysis_id</strong> – Unique identifier, filesystem-safe</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Minimal usage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generate_analysis_id</span><span class="p">(</span><span class="s2">&quot;CFPAC&quot;</span><span class="p">,</span> <span class="s2">&quot;control&quot;</span><span class="p">)</span>
<span class="go">&#39;CFPAC_control_20251113_142315&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># With cell cycle phase info</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generate_analysis_id</span><span class="p">(</span><span class="s2">&quot;HPAC&quot;</span><span class="p">,</span> <span class="s2">&quot;ERK2000&quot;</span><span class="p">,</span> <span class="s2">&quot;g0g1&quot;</span><span class="p">)</span>
<span class="go">&#39;HPAC_ERK2000_g0g1_20251113_150430&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># With treatment duration</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generate_analysis_id</span><span class="p">(</span><span class="s2">&quot;BxPC3&quot;</span><span class="p">,</span> <span class="s2">&quot;Fra1_KD&quot;</span><span class="p">,</span> <span class="s2">&quot;48h&quot;</span><span class="p">)</span>
<span class="go">&#39;BxPC3_Fra1_KD_48h_20251113_160530&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Reproducible ID (for testing)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generate_analysis_id</span><span class="p">(</span><span class="s2">&quot;CFPAC&quot;</span><span class="p">,</span> <span class="s2">&quot;control&quot;</span><span class="p">,</span> <span class="s2">&quot;g0g1&quot;</span><span class="p">,</span> <span class="s2">&quot;20251113_120000&quot;</span><span class="p">)</span>
<span class="go">&#39;CFPAC_control_g0g1_20251113_120000&#39;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># In a double loop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">cell_line</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CFPAC&#39;</span><span class="p">,</span> <span class="s1">&#39;HPAC&#39;</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">condition</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;control&#39;</span><span class="p">,</span> <span class="s1">&#39;ERK2000&#39;</span><span class="p">]:</span>
<span class="gp">... </span>        <span class="n">aid</span> <span class="o">=</span> <span class="n">generate_analysis_id</span><span class="p">(</span><span class="n">cell_line</span><span class="p">,</span> <span class="n">condition</span><span class="p">,</span> <span class="s2">&quot;g0g1&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="n">aid</span><span class="p">)</span>
<span class="go">&#39;CFPAC_control_g0g1_20251113_142315&#39;</span>
<span class="go">&#39;CFPAC_ERK2000_g0g1_20251113_142316&#39;</span>
<span class="go">&#39;HPAC_control_g0g1_20251113_142317&#39;</span>
<span class="go">&#39;HPAC_ERK2000_g0g1_20251113_142318&#39;</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>IDs are filesystem-safe (spaces/special chars converted to underscores)</p></li>
<li><p>Timestamp ensures uniqueness even for same cell line/condition</p></li>
<li><p>additional_info is optional for flexibility</p></li>
<li><p>All components sanitized to prevent filesystem issues</p></li>
</ul>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">elastic_net_modules.results_manager.</span></span><span class="sig-name descname"><span class="pre">ElasticNetResultsManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_line</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'results'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analysis_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/results_manager.html#ElasticNetResultsManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="Link to this definition"></a></dt>
<dd><p>Manages all outputs for a single Elastic Net analysis run.</p>
<p>Automatically organizes:
- Model evaluation results (CSV + PKL)
- Diagnostic plots (organized by type)
- Final trained classifier
- Preprocessing outputs (GMM histograms)
- Warnings and logs
- Metadata (who, what, when, how)</p>
<section id="design-philosophy">
<h3>Design Philosophy:<a class="headerlink" href="#design-philosophy" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>One manager = One complete analysis</p></li>
<li><p>Automatic directory creation</p></li>
<li><p>Prevents overwrites (unique IDs)</p></li>
<li><p>Tracks provenance (metadata)</p></li>
<li><p>Easy to use (minimal boilerplate)</p></li>
</ul>
</section>
<section id="directory-structure-created">
<h3>Directory Structure Created:<a class="headerlink" href="#directory-structure-created" title="Link to this heading"></a></h3>
<p>results/
└── {analysis_id}/</p>
<blockquote>
<div><p>├── metadata.json              ← Analysis configuration
├── README.md                  ← Human-readable summary
├── all_models.csv             ← Excel-compatible results
├── all_models.pkl             ← Python-compatible (preserves types)
├── checkpoints/               ← Temporary (cleaned up after use)
├── warnings/
│   └── warnings_log_{timestamp}.csv
├── plots/
│   ├── model_selection.png
│   ├── coefficient_stability.png
│   └── …
├── models/
│   └── final_classifier.pkl
└── preprocessing/</p>
<blockquote>
<div><p>├── ploidy_gmm_histogram.png
└── proliferation_gmm_histogram.png</p>
</div></blockquote>
</div></blockquote>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Initialize manager (creates unique folder + metadata)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span> <span class="o">=</span> <span class="n">ElasticNetResultsManager</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">cell_line</span><span class="o">=</span><span class="s2">&quot;CFPAC&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">condition</span><span class="o">=</span><span class="s2">&quot;control&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">additional_info</span><span class="o">=</span><span class="s2">&quot;g0g1&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">manager</span><span class="o">.</span><span class="n">analysis_id</span><span class="p">)</span>
<span class="go">&#39;CFPAC_control_g0g1_20251113_142315&#39;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># All outputs automatically organized</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span><span class="o">.</span><span class="n">save_model_results</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>  <span class="c1"># Saves CSV + PKL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span><span class="o">.</span><span class="n">save_plot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s2">&quot;model_selection&quot;</span><span class="p">)</span>  <span class="c1"># Saves to plots/</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span><span class="o">.</span><span class="n">save_final_classifier</span><span class="p">(</span><span class="n">classifier</span><span class="p">)</span>  <span class="c1"># Saves to models/</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate human-readable summary</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span><span class="o">.</span><span class="n">create_summary</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Double loop example (batch processing)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">cell_line</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CFPAC&#39;</span><span class="p">,</span> <span class="s1">&#39;HPAC&#39;</span><span class="p">,</span> <span class="s1">&#39;BxPC3&#39;</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">condition</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;control&#39;</span><span class="p">,</span> <span class="s1">&#39;ERK2000&#39;</span><span class="p">]:</span>
<span class="gp">... </span>        <span class="n">manager</span> <span class="o">=</span> <span class="n">ElasticNetResultsManager</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">cell_line</span><span class="o">=</span><span class="n">cell_line</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">additional_info</span><span class="o">=</span><span class="s2">&quot;g0g1&quot;</span>
<span class="gp">... </span>        <span class="p">)</span>
<span class="gp">... </span>        <span class="c1"># Run analysis with this manager...</span>
<span class="gp">... </span>        <span class="n">results_df</span> <span class="o">=</span> <span class="n">evaluate_all_feature_sets</span><span class="p">(</span>
<span class="gp">... </span>            <span class="n">adata</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">feature_combos</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span>
<span class="gp">... </span>            <span class="n">results_manager</span><span class="o">=</span><span class="n">manager</span>
<span class="gp">... </span>        <span class="p">)</span>
<span class="gp">... </span>        <span class="n">manager</span><span class="o">.</span><span class="n">save_model_results</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>
<span class="gp">... </span>        <span class="c1"># ...etc</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_line</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'results'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">analysis_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/results_manager.html#ElasticNetResultsManager.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize results manager for a new analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_line</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Cell line name (e.g., ‘CFPAC’, ‘HPAC’, ‘Pa02C’)</p></li>
<li><p><strong>condition</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Experimental condition (e.g., ‘control’, ‘ERK2000’, ‘Fra1_KD’)</p></li>
<li><p><strong>additional_info</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Optional descriptor (e.g., ‘g0g1’, ‘nonprolif’, ‘allcells’, ‘48h’)
If None, omitted from analysis_id</p></li>
<li><p><strong>base_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Base directory for all results (default: ‘results’)</p></li>
<li><p><strong>analysis_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>) – Use specific analysis ID (for loading existing results)
If None, generates new ID with current timestamp</p></li>
<li><p><strong>Effects</strong> (<em>Side</em>)</p></li>
<li><p><strong>------------</strong></p></li>
<li><p><strong>{base_dir}/{analysis_id}/</strong> (<em>- Creates directory structure under</em>)</p></li>
<li><p><strong>metadata.json</strong> (<em>- Saves initial</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.analysis_id">
<span class="sig-name descname"><span class="pre">analysis_id</span></span><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.analysis_id" title="Link to this definition"></a></dt>
<dd><p>Unique identifier for this analysis</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.cell_line">
<span class="sig-name descname"><span class="pre">cell_line</span></span><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.cell_line" title="Link to this definition"></a></dt>
<dd><p>Cell line name (stored for metadata)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.condition">
<span class="sig-name descname"><span class="pre">condition</span></span><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.condition" title="Link to this definition"></a></dt>
<dd><p>Experimental condition (stored for metadata)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.additional_info">
<span class="sig-name descname"><span class="pre">additional_info</span></span><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.additional_info" title="Link to this definition"></a></dt>
<dd><p>Additional descriptor (stored for metadata)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a> or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.base_dir">
<span class="sig-name descname"><span class="pre">base_dir</span></span><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.base_dir" title="Link to this definition"></a></dt>
<dd><p>Root directory for all results</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.analysis_dir">
<span class="sig-name descname"><span class="pre">analysis_dir</span></span><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.analysis_dir" title="Link to this definition"></a></dt>
<dd><p>Full path to this analysis folder</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.dirs">
<span class="sig-name descname"><span class="pre">dirs</span></span><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.dirs" title="Link to this definition"></a></dt>
<dd><p>Paths to all subdirectories:
- ‘checkpoints’: For evaluate_all_feature_sets()
- ‘warnings’: For warning logs
- ‘plots’: For diagnostic plots
- ‘models’: For final classifier
- ‘preprocessing’: For GMM histograms</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.metadata" title="Link to this definition"></a></dt>
<dd><p>Analysis configuration and parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.save_metadata">
<span class="sig-name descname"><span class="pre">save_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/results_manager.html#ElasticNetResultsManager.save_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.save_metadata" title="Link to this definition"></a></dt>
<dd><p>Save or update analysis metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Arbitrary metadata to save/update
Common keys:
- data_file: str (path to input data)
- n_cells_original: int
- n_cells_final: int
- filter_2n: bool
- fra1_filter_config: dict
- hyperparameters: dict
- cv_config: dict
- selected_model: dict</p></li>
<li><p><strong>to</strong> (<em>Saves</em>)</p></li>
<li><p><strong>---------</strong></p></li>
<li><p><strong>{analysis_dir}/metadata.json</strong></p></li>
<li><p><strong>Structure</strong> (<em>Example Metadata</em>)</p></li>
<li><p><strong>---------------------------</strong></p></li>
<li><p><strong>{</strong> – <p>“analysis_id”: “CFPAC_control_g0g1_20251113_142315”,
“cell_line”: “CFPAC”,
“condition”: “control”,
“additional_info”: “g0g1”,
“timestamp”: “2025-11-13T14:23:15”,
“data_file”: “/path/to/data.h5ad”,
“n_cells_original”: 50000,
“n_cells_final”: 32000,
“filter_2n”: true,
“fra1_filter”: {</p>
<blockquote>
<div><p>”enabled”: true,
“percentile”: 90,
“reference”: “nonprolif”</p>
</div></blockquote>
<p>},
“hyperparameters”: {“C”: […], “l1_ratio”: […]},
“cv_config”: {“outer_splits”: 10, …},
“selected_model”: {</p>
<blockquote>
<div><p>”model_id”: 42,
“model_name”: “CycD1_CDK4_p27”,
“mean_auroc”: 0.941</p>
</div></blockquote>
<p>}</p>
</p></li>
<li><p><strong>}</strong></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Called automatically on __init__</p></li>
<li><p>Can be called multiple times to update metadata</p></li>
<li><p>Updates are merged with existing metadata</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.save_model_results">
<span class="sig-name descname"><span class="pre">save_model_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/results_manager.html#ElasticNetResultsManager.save_model_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.save_model_results" title="Link to this definition"></a></dt>
<dd><p>Save model evaluation results in dual format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results_df</strong> (<em>pd.DataFrame</em>) – Output from evaluate_all_feature_sets()</p></li>
<li><p><strong>to</strong> (<em>Saves</em>)</p></li>
<li><p><strong>---------</strong></p></li>
<li><p><strong>Human-readable</strong> (<em>- {analysis_dir}/all_models.csv  #</em>)</p></li>
<li><p><strong>Excel-compatible</strong></p></li>
<li><p><strong>(</strong><strong>lists</strong> (<em>- {analysis_dir}/all_models.pkl  # Preserves Python types</em>)</p></li>
<li><p><strong>dicts</strong><strong>)</strong></p></li>
<li><p><strong>Formats?</strong> (<em>Why Both</em>)</p></li>
<li><p><strong>-----------------</strong></p></li>
<li><p><strong>CSV</strong> (<em>-</em>)</p></li>
<li><p><strong>PKL</strong> (<em>-</em>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">results_df</span> <span class="o">=</span> <span class="n">evaluate_all_feature_sets</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span><span class="o">.</span><span class="n">save_model_results</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Later, reload:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results_df</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">load_model_results</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.load_model_results">
<span class="sig-name descname"><span class="pre">load_model_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/results_manager.html#ElasticNetResultsManager.load_model_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.load_model_results" title="Link to this definition"></a></dt>
<dd><p>Load previously saved model results.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>results_df</strong> – Full results with Python types preserved (from PKL)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.14)"><strong>FileNotFoundError</strong></a> – If all_models.pkl doesn’t exist</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load existing analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span> <span class="o">=</span> <span class="n">ElasticNetResultsManager</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;CFPAC_control_g0g1_20251113_142315&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results_df</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">load_model_results</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.save_plot">
<span class="sig-name descname"><span class="pre">save_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Figure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox_inches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'tight'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/results_manager.html#ElasticNetResultsManager.save_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.save_plot" title="Link to this definition"></a></dt>
<dd><p>Save plot with automatic naming and organization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.Figure</em>) – Figure to save</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Base name (without extension)
Examples: ‘model_selection’, ‘coefficient_stability’, ‘threshold_sweep’</p></li>
<li><p><strong>dpi</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Resolution (default 150 for publication quality)</p></li>
<li><p><strong>bbox_inches</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Bounding box (default ‘tight’ to avoid clipping)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>save_path</strong> (<em>Path</em>) – Full path to saved plot</p></li>
<li><p><em>Saves to</em></p></li>
<li><p><em>———</em></p></li>
<li><p><em>{analysis_dir}/plots/{name}.png</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_model_selection</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">selection</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span><span class="o">.</span><span class="n">save_plot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;model_selection&#39;</span><span class="p">)</span>
<span class="go">PosixPath(&#39;.../CFPAC_control_g0g1_20251113_142315/plots/model_selection.png&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.save_preprocessing_plot">
<span class="sig-name descname"><span class="pre">save_preprocessing_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Figure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/results_manager.html#ElasticNetResultsManager.save_preprocessing_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.save_preprocessing_plot" title="Link to this definition"></a></dt>
<dd><p>Save preprocessing diagnostic plot (GMM histograms).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.Figure</em>) – Histogram from GMM labeling</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Plot name (e.g., ‘ploidy_gmm_histogram’, ‘proliferation_gmm_histogram’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>save_path</strong> (<em>Path</em>) – Full path to saved plot</p></li>
<li><p><em>Saves to</em></p></li>
<li><p><em>———</em></p></li>
<li><p><em>{analysis_dir}/preprocessing/{name}.png</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># In label_ploidy_and_proliferation_gmm()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ... create histogram ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span><span class="o">.</span><span class="n">save_preprocessing_plot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;ploidy_gmm_histogram&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.save_final_classifier">
<span class="sig-name descname"><span class="pre">save_final_classifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/results_manager.html#ElasticNetResultsManager.save_final_classifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.save_final_classifier" title="Link to this definition"></a></dt>
<dd><p>Save final trained classifier for deployment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>classifier_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Output from build_final_classifier()
Contains: model, scaler, feature_names, optimal_threshold, etc.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>save_path</strong> (<em>Path</em>) – Full path to saved classifier</p></li>
<li><p><em>Saves to</em></p></li>
<li><p><em>———</em></p></li>
<li><p><em>{analysis_dir}/models/final_classifier.pkl</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">classifier</span> <span class="o">=</span> <span class="n">build_final_classifier</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span><span class="o">.</span><span class="n">save_final_classifier</span><span class="p">(</span><span class="n">classifier</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Later, reload:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">classifier</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">load_final_classifier</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.load_final_classifier">
<span class="sig-name descname"><span class="pre">load_final_classifier</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/results_manager.html#ElasticNetResultsManager.load_final_classifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.load_final_classifier" title="Link to this definition"></a></dt>
<dd><p>Load previously saved classifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>classifier_dict</strong> – Complete classifier package ready for deployment</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.14)"><strong>FileNotFoundError</strong></a> – If final_classifier.pkl doesn’t exist</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span> <span class="o">=</span> <span class="n">ElasticNetResultsManager</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;CFPAC_control_g0g1_20251113_142315&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">classifier</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">load_final_classifier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Deploy on new data...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.get_checkpoint_dir">
<span class="sig-name descname"><span class="pre">get_checkpoint_dir</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/results_manager.html#ElasticNetResultsManager.get_checkpoint_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.get_checkpoint_dir" title="Link to this definition"></a></dt>
<dd><p>Get checkpoint directory path for evaluate_all_feature_sets().</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>checkpoint_dir</strong> – Path to checkpoints/ subdirectory (as string for compatibility)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">results_df</span> <span class="o">=</span> <span class="n">evaluate_all_feature_sets</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">adata</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">feature_combos</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">results_dir</span><span class="o">=</span><span class="n">manager</span><span class="o">.</span><span class="n">get_checkpoint_dir</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="o">...</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.add_preprocessing_info">
<span class="sig-name descname"><span class="pre">add_preprocessing_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prep_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/results_manager.html#ElasticNetResultsManager.add_preprocessing_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.add_preprocessing_info" title="Link to this definition"></a></dt>
<dd><p>Add preprocessing information to metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prep_info</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Output from prepare_data_for_elastic_net()
Contains cell counts, filter settings, etc.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adata_prep</span><span class="p">,</span> <span class="n">prep_info</span> <span class="o">=</span> <span class="n">prepare_data_for_elastic_net</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span><span class="o">.</span><span class="n">add_preprocessing_info</span><span class="p">(</span><span class="n">prep_info</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.create_summary">
<span class="sig-name descname"><span class="pre">create_summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/results_manager.html#ElasticNetResultsManager.create_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.create_summary" title="Link to this definition"></a></dt>
<dd><p>Generate human-readable analysis summary.</p>
<p>Creates README.md with:
- Analysis identifier and parameters
- Cell counts and filtering steps
- Selected model details (if available)
- File organization guide
- How to reload results</p>
<section id="saves-to">
<h4>Saves to:<a class="headerlink" href="#saves-to" title="Link to this heading"></a></h4>
<p>{analysis_dir}/README.md</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span><span class="o">.</span><span class="n">create_summary</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Creates comprehensive README for this analysis</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="elastic_net_modules.results_manager.ElasticNetResultsManager.load">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">analysis_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'results'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/elastic_net_modules/results_manager.html#ElasticNetResultsManager.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.results_manager.ElasticNetResultsManager.load" title="Link to this definition"></a></dt>
<dd><p>Load existing analysis results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>analysis_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – ID of analysis to load (full folder name)</p></li>
<li><p><strong>base_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Base results directory (default: ‘results’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>manager</strong> – Manager instance with access to all saved results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager">ElasticNetResultsManager</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.14)"><strong>FileNotFoundError</strong></a> – If analysis directory or metadata.json doesn’t exist</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load previous analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span> <span class="o">=</span> <span class="n">ElasticNetResultsManager</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s2">&quot;CFPAC_control_g0g1_20251113_142315&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results_df</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">load_model_results</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">classifier</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">load_final_classifier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">manager</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</dd></dl>

</section>
<section id="module-elastic_net_modules.visualization">
<span id="visualization"></span><h2>Visualization<a class="headerlink" href="#module-elastic_net_modules.visualization" title="Link to this heading"></a></h2>
<p>Visualization Module for Elastic Net Analysis Pipeline</p>
<p>This module provides professional, publication-ready diagnostic plots for
the Elastic Net cell cycle analysis pipeline.</p>
<dl class="simple">
<dt>Functions:</dt><dd><ul class="simple">
<li><p>plot_model_selection(): Model comparison with 1-SE threshold</p></li>
<li><p>plot_coefficient_stability(): Coefficient consistency across folds</p></li>
<li><p>plot_feature_importance(): Final model coefficient bar chart</p></li>
<li><p>plot_threshold_sweep(): MCC optimization curve</p></li>
<li><p>plot_null_distribution(): Null model test visualization</p></li>
<li><p>plot_bootstrap_distribution(): Bootstrap CI visualization</p></li>
<li><p>plot_performance_summary(): AUROC vs features panel</p></li>
<li><p>create_summary_report(): Comprehensive HTML report (future)</p></li>
</ul>
</dd>
<dt>Design Philosophy:</dt><dd><ul class="simple">
<li><p>Input flexibility: Accept results dicts, DataFrames, or arrays</p></li>
<li><p>Consistent styling: Professional matplotlib/seaborn theme</p></li>
<li><p>Save capability: All functions support save_path parameter</p></li>
<li><p>Publication ready: High DPI, tight layouts, clear fonts</p></li>
</ul>
</dd>
</dl>
<p>Author: AI Assistant
Date: November 13, 2025</p>
<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.visualization.plot_model_selection">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_model_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><span class="pre">ElasticNetResultsManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(12,</span> <span class="pre">6)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/elastic_net_modules/visualization.html#plot_model_selection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.visualization.plot_model_selection" title="Link to this definition"></a></dt>
<dd><p>Create bar chart showing all models with 1-SE threshold line.</p>
<p>Recreates the chart from the HTML protocol, showing all models
sorted by AUROC with error bars and selection highlighting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results_df</strong> (<em>pd.DataFrame</em>) – Output from evaluate_all_feature_sets()
Must have: model_id, model_name, mean_auroc, se_auroc</p></li>
<li><p><strong>selection_results</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Output from apply_1se_rule()
Must have: best_model, primary_model, threshold</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>None</em>) – If provided, save figure to this path (overrides results_manager)</p></li>
<li><p><strong>results_manager</strong> (<a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><em>ElasticNetResultsManager</em></a><em> or </em><em>None</em>) – If provided and save_path is None, auto-saves via manager.save_plot()</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – Figure size (width, height) in inches</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig, ax</strong> (<em>matplotlib figure and axis</em>)</p></li>
<li><p><em>Visual Elements</em></p></li>
<li><p><em>—————</em></p></li>
<li><p><em>- Bar chart sorted by AUROC (descending)</em></p></li>
<li><p><em>- Error bars showing ±1 SE</em></p></li>
<li><p><em>- Red star marking best model</em></p></li>
<li><p><em>- Green star marking selected model (1-SE rule)</em></p></li>
<li><p><em>- Horizontal dashed line at 1-SE threshold</em></p></li>
<li><p><strong>- Color-coded bars</strong> (<em>gray (all), highlighted for best/selected</em>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">results_df</span> <span class="o">=</span> <span class="n">evaluate_all_feature_sets</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">selection</span> <span class="o">=</span> <span class="n">apply_1se_rule</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_model_selection</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">selection</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;model_selection.png&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.visualization.plot_coefficient_stability">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_coefficient_stability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stability_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><span class="pre">ElasticNetResultsManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(12,</span> <span class="pre">8)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/elastic_net_modules/visualization.html#plot_coefficient_stability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.visualization.plot_coefficient_stability" title="Link to this definition"></a></dt>
<dd><p>Create horizontal bar chart with error bars showing coefficient stability.</p>
<p>Color-codes features by stability (green=stable, red=unstable) and
shows mean ± std dev across CV folds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stability_df</strong> (<em>pd.DataFrame</em>) – Output from coefficient_stability_check()
Must have: feature, mean_coef, std_coef, is_stable</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>None</em>) – If provided, save figure to this path (overrides results_manager)</p></li>
<li><p><strong>results_manager</strong> (<a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><em>ElasticNetResultsManager</em></a><em> or </em><em>None</em>) – If provided and save_path is None, auto-saves via manager.save_plot()</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – Figure size (width, height)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig, ax</strong> (<em>matplotlib figure and axis</em>)</p></li>
<li><p><em>Visual Elements</em></p></li>
<li><p><em>—————</em></p></li>
<li><p><em>- Horizontal bars sorted by |mean_coef| (most important first)</em></p></li>
<li><p><em>- Error bars showing ±1 std dev</em></p></li>
<li><p><strong>- Green bars</strong> (<em>stable features (all folds same sign)</em>)</p></li>
<li><p><strong>- Red bars</strong> (<em>unstable features (sign flipping)</em>)</p></li>
<li><p><em>- Vertical line at zero</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stability_df</span> <span class="o">=</span> <span class="n">coefficient_stability_check</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_coefficient_stability</span><span class="p">(</span><span class="n">stability_df</span><span class="p">,</span>
<span class="gp">... </span>                                       <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;coef_stability.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.visualization.plot_feature_importance">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_feature_importance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">final_classifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><span class="pre">ElasticNetResultsManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(10,</span> <span class="pre">6)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/elastic_net_modules/visualization.html#plot_feature_importance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.visualization.plot_feature_importance" title="Link to this definition"></a></dt>
<dd><p>Bar chart of final model coefficients.</p>
<p>Shows which features are most important for prediction.
Positive coefficients increase proliferation probability.
Negative coefficients decrease proliferation probability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>final_classifier</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Output from build_final_classifier()
Must have: ‘feature_names’, ‘model’ (with .coef_ attribute)</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>None</em>) – If provided, save figure to this path (overrides results_manager)</p></li>
<li><p><strong>results_manager</strong> (<a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><em>ElasticNetResultsManager</em></a><em> or </em><em>None</em>) – If provided and save_path is None, auto-saves via manager.save_plot()</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – Figure size</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig, ax</strong> (<em>matplotlib figure and axis</em>)</p></li>
<li><p><em>Visual Elements</em></p></li>
<li><p><em>—————</em></p></li>
<li><p><em>- Horizontal bar chart sorted by |coefficient|</em></p></li>
<li><p><strong>- Green bars</strong> (<em>positive coefficients (pro-proliferation)</em>)</p></li>
<li><p><strong>- Red bars</strong> (<em>negative coefficients (anti-proliferation)</em>)</p></li>
<li><p><em>- Vertical line at zero</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">final_classifier</span> <span class="o">=</span> <span class="n">build_final_classifier</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_feature_importance</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">final_classifier</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;feature_importance.png&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.visualization.plot_threshold_sweep">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_threshold_sweep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold_curve</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimal_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><span class="pre">ElasticNetResultsManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(10,</span> <span class="pre">6)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/elastic_net_modules/visualization.html#plot_threshold_sweep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.visualization.plot_threshold_sweep" title="Link to this definition"></a></dt>
<dd><p>Plot metric value vs threshold, highlighting optimal threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>threshold_curve</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – From find_optimal_threshold() output or final_classifier[‘threshold_curve’]
Must have: ‘thresholds’, ‘mcc_values’ (or other metric)</p></li>
<li><p><strong>optimal_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – The selected optimal threshold value</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>None</em>) – If provided, save figure to this path (overrides results_manager)</p></li>
<li><p><strong>results_manager</strong> (<a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><em>ElasticNetResultsManager</em></a><em> or </em><em>None</em>) – If provided and save_path is None, auto-saves via manager.save_plot()</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – Figure size</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig, ax</strong> (<em>matplotlib figure and axis</em>)</p></li>
<li><p><em>Visual Elements</em></p></li>
<li><p><em>—————</em></p></li>
<li><p><strong>- Line plot</strong> (<em>threshold vs metric (e.g., MCC)</em>)</p></li>
<li><p><em>- Vertical red dashed line at optimal threshold</em></p></li>
<li><p><em>- Horizontal green dashed line at max metric value</em></p></li>
<li><p><em>- Annotation box with optimal values</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">build_final_classifier</span> <span class="n">output</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_threshold_sweep</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">final_classifier</span><span class="p">[</span><span class="s1">&#39;threshold_curve&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">final_classifier</span><span class="p">[</span><span class="s1">&#39;optimal_threshold&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;threshold_sweep.png&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.visualization.plot_null_distribution">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_null_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">null_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><span class="pre">ElasticNetResultsManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(10,</span> <span class="pre">6)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/elastic_net_modules/visualization.html#plot_null_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.visualization.plot_null_distribution" title="Link to this definition"></a></dt>
<dd><p>Plot null model test distribution.</p>
<p>Shows histogram of AUROC values from shuffled labels (null distribution)
compared to true model AUROC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>null_results</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – Output from null_model_test()
Must have: true_model_auroc, null_aurocs, mean_null_auroc, p_value, is_significant</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>None</em>) – If provided, save figure to this path (overrides results_manager)</p></li>
<li><p><strong>results_manager</strong> (<a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><em>ElasticNetResultsManager</em></a><em> or </em><em>None</em>) – If provided and save_path is None, auto-saves via manager.save_plot()</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – Figure size</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig, ax</strong> (<em>matplotlib figure and axis</em>)</p></li>
<li><p><em>Visual Elements</em></p></li>
<li><p><em>—————</em></p></li>
<li><p><em>- Histogram of null AUROCs (gray)</em></p></li>
<li><p><em>- Vertical line at true AUROC (red)</em></p></li>
<li><p><em>- Vertical line at mean null AUROC (blue)</em></p></li>
<li><p><em>- Text box with p-value and significance</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">null_results</span> <span class="o">=</span> <span class="n">null_model_test</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_null_distribution</span><span class="p">(</span><span class="n">null_results</span><span class="p">,</span> <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;null_test.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.visualization.plot_bootstrap_distribution">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_bootstrap_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bootstrap_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><span class="pre">ElasticNetResultsManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(10,</span> <span class="pre">6)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/elastic_net_modules/visualization.html#plot_bootstrap_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.visualization.plot_bootstrap_distribution" title="Link to this definition"></a></dt>
<dd><p>Plot bootstrap confidence interval distribution.</p>
<p>Shows histogram of bootstrap AUROC values with confidence intervals
and summary statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bootstrap_results</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – <p>Output from bootstrap_confidence_intervals()
Must have: bootstrap_aurocs, mean_auroc, median_auroc, ci_lower,</p>
<blockquote>
<div><p>ci_upper, n_bootstrap</p>
</div></blockquote>
</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>None</em>) – If provided, save figure to this path (overrides results_manager)</p></li>
<li><p><strong>results_manager</strong> (<a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><em>ElasticNetResultsManager</em></a><em> or </em><em>None</em>) – If provided and save_path is None, auto-saves via manager.save_plot()</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – Figure size</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig, ax</strong> (<em>matplotlib figure and axis</em>)</p></li>
<li><p><em>Visual Elements</em></p></li>
<li><p><em>—————</em></p></li>
<li><p><em>- Histogram of bootstrap AUROCs (skyblue)</em></p></li>
<li><p><em>- Vertical line at mean (red)</em></p></li>
<li><p><em>- Vertical line at median (orange)</em></p></li>
<li><p><em>- Vertical lines at CI bounds (green)</em></p></li>
<li><p><em>- Text box with CI width and interpretation</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bootstrap_results</span> <span class="o">=</span> <span class="n">bootstrap_confidence_intervals</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_bootstrap_distribution</span><span class="p">(</span><span class="n">bootstrap_results</span><span class="p">,</span>
<span class="gp">... </span>                                        <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;bootstrap_ci.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.visualization.plot_performance_summary">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_performance_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.3)"><span class="pre">DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><span class="pre">ElasticNetResultsManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(14,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Figure</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/elastic_net_modules/visualization.html#plot_performance_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.visualization.plot_performance_summary" title="Link to this definition"></a></dt>
<dd><p>Create summary panel with AUROC vs features and AUROC distribution.</p>
<p>Two-panel figure showing:
1. AUROC vs number of base features (scatter with error bars)
2. AUROC distribution histogram</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>results_df</strong> (<em>pd.DataFrame</em>) – Output from evaluate_all_feature_sets()
Must have: n_base_features, mean_auroc, se_auroc</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>None</em>) – If provided, save figure to this path (overrides results_manager)</p></li>
<li><p><strong>results_manager</strong> (<a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><em>ElasticNetResultsManager</em></a><em> or </em><em>None</em>) – If provided and save_path is None, auto-saves via manager.save_plot()</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – Figure size (width, height)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig, axes</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib figure and array of axes</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">results_df</span> <span class="o">=</span> <span class="n">evaluate_all_feature_sets</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plot_performance_summary</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span>
<span class="gp">... </span>                                       <span class="n">save_path</span><span class="o">=</span><span class="s1">&#39;performance_summary.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="elastic_net_modules.visualization.plot_scatter_kde">
<span class="sig-prename descclassname"><span class="pre">elastic_net_modules.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_scatter_kde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_feature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_feature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><span class="pre">ElasticNetResultsManager</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(10,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scatter_alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kde_levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim_percentile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim_percentile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a></span></span><a class="reference internal" href="_modules/elastic_net_modules/visualization.html#plot_scatter_kde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#elastic_net_modules.visualization.plot_scatter_kde" title="Link to this definition"></a></dt>
<dd><p>Create scatter plot with 2D KDE contours and marginal distributions.</p>
<p>Visualizes relationship between two features (single or ratio) with
proliferation labels, showing 2D KDE contours and optional thresholds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>AnnData</em>) – AnnData object containing features and labels</p></li>
<li><p><strong>x_feature</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – X-axis feature. Single feature name or (numerator, denominator) for ratio
Example: ‘Int_Med_Fra1_nuc’ or (‘Int_Med_pRB_nuc’, ‘Int_Med_RB_nuc’)</p></li>
<li><p><strong>y_feature</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – Y-axis feature. Single feature name or (numerator, denominator) for ratio</p></li>
<li><p><strong>label_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Column name in adata.obs for binary labels (e.g., ‘prolif_gmm_label’)</p></li>
<li><p><strong>x_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>None</em>) – Optional vertical line threshold for x-axis (e.g., filter cutoff)</p></li>
<li><p><strong>y_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>None</em>) – Optional horizontal line threshold for y-axis</p></li>
<li><p><strong>save_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>None</em>) – If provided, save figure to this path (overrides results_manager)</p></li>
<li><p><strong>results_manager</strong> (<a class="reference internal" href="#elastic_net_modules.results_manager.ElasticNetResultsManager" title="elastic_net_modules.results_manager.ElasticNetResultsManager"><em>ElasticNetResultsManager</em></a><em> or </em><em>None</em>) – If provided and save_path is None, auto-saves via manager.save_plot()</p></li>
<li><p><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a>) – Figure size (width, height)</p></li>
<li><p><strong>scatter_alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Transparency of scatter points (0-1)</p></li>
<li><p><strong>kde_levels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of contour levels for 2D KDE</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> or </em><em>None</em>) – Custom title. If None, auto-generates from features</p></li>
<li><p><strong>xlim_percentile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><em>floats</em><em>, or </em><em>None</em>) – <p>If float: set upper x-axis limit to this percentile, auto-scale lower (e.g., 99)
If tuple: set (lower, upper) x-axis limits to these percentiles (e.g., (1, 99))</p>
<blockquote>
<div><p>Can use None in tuple to skip a bound (e.g., (None, 99) for upper only)</p>
</div></blockquote>
<p>If None: auto-scale both limits (default)</p>
</p></li>
<li><p><strong>ylim_percentile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em> of </em><em>floats</em><em>, or </em><em>None</em>) – <p>If float: set upper y-axis limit to this percentile, auto-scale lower (e.g., 99)
If tuple: set (lower, upper) y-axis limits to these percentiles (e.g., (1, 99))</p>
<blockquote>
<div><p>Can use None in tuple to skip a bound (e.g., (None, 99) for upper only)</p>
</div></blockquote>
<p>If None: auto-scale both limits (default)</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig, axes</strong> (<em>matplotlib figure and dict of axes</em>) – axes dict has keys: ‘main’, ‘top’, ‘right’</p></li>
<li><p><em>Visual Elements</em></p></li>
<li><p><em>—————</em></p></li>
<li><p><em>Layout</em> –</p>
<ul>
<li><p>Main: Scatter plot with 2D KDE contours (colored by label)</p></li>
<li><p>Top: X-axis marginal distribution (1D KDE per label)</p></li>
<li><p>Right: Y-axis marginal distribution (1D KDE per label)</p></li>
</ul>
</li>
<li><p><em>Features</em> –</p>
<ul>
<li><p>Scatter points colored by label class</p></li>
<li><p>2D KDE contours for each label class</p></li>
<li><p>Dashed red lines for thresholds (if provided)</p></li>
<li><p>Marginal 1D KDE distributions</p></li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Single features with upper percentile limit only</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plot_scatter_kde</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">adata</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">x_feature</span><span class="o">=</span><span class="s1">&#39;Int_Med_Fra1_nuc&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">y_feature</span><span class="o">=</span><span class="s1">&#39;Int_Med_PCNA_nuc&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">label_key</span><span class="o">=</span><span class="s1">&#39;prolif_gmm_label&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">x_threshold</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">xlim_percentile</span><span class="o">=</span><span class="mi">99</span>  <span class="c1"># Only set upper limit to 99th percentile</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># With both lower and upper percentile limits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plot_scatter_kde</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">adata</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">x_feature</span><span class="o">=</span><span class="s1">&#39;Int_Med_Fra1_nuc&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">y_feature</span><span class="o">=</span><span class="s1">&#39;Int_Med_PCNA_nuc&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">label_key</span><span class="o">=</span><span class="s1">&#39;prolif_gmm_label&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">xlim_percentile</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">),</span>  <span class="c1"># Set both limits</span>
<span class="gp">... </span>    <span class="n">ylim_percentile</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># With None in tuple to specify only one bound</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plot_scatter_kde</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">adata</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">x_feature</span><span class="o">=</span><span class="s1">&#39;Int_Med_Fra1_nuc&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">y_feature</span><span class="o">=</span><span class="s1">&#39;Int_Med_PCNA_nuc&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">label_key</span><span class="o">=</span><span class="s1">&#39;prolif_gmm_label&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">xlim_percentile</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">99</span><span class="p">),</span>  <span class="c1"># Only upper, same as xlim_percentile=99</span>
<span class="gp">... </span>    <span class="n">ylim_percentile</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>     <span class="c1"># Only lower limit</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Ratio feature with auto-save</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plot_scatter_kde</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">adata</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">x_feature</span><span class="o">=</span><span class="s1">&#39;Int_Med_Fra1_nuc&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">y_feature</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Int_Med_pRB_nuc&#39;</span><span class="p">,</span> <span class="s1">&#39;Int_Med_RB_nuc&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">label_key</span><span class="o">=</span><span class="s1">&#39;prolif_gmm_label&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">results_manager</span><span class="o">=</span><span class="n">manager</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="workflow_index.html" class="btn btn-neutral float-left" title="Auto-Discovery Workflow Index" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="notebooks.html" class="btn btn-neutral float-right" title="Notebook Workflows" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Your Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>